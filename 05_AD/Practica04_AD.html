
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://fjavier-hernandez.github.io/aso/05_AD/Practica04_AD.html">
      
      <link rel="icon" href="../imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Instalación de Active Directory I - Administración de Sistemas Operativos</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="javi" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#instalacion-de-active-directory-i" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../index.html" title="Administración de Sistemas Operativos" class="md-header__button md-logo" aria-label="Administración de Sistemas Operativos" data-md-component="logo">
      
  <img src="../imagenes/logofp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Administración de Sistemas Operativos
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Instalación de Active Directory I
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="javi" data-md-color-primary="" data-md-color-accent=""  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Administración de Sistemas Operativos" class="md-nav__button md-logo" aria-label="Administración de Sistemas Operativos" data-md-component="logo">
      
  <img src="../imagenes/logofp.png" alt="logo">

    </a>
    Administración de Sistemas Operativos
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          1.- UD1. ShellScripting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="1.- UD1. ShellScripting" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          1.- UD1. ShellScripting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01_ShellScripting/ProgramacionAula.html" class="md-nav__link">
        Programación de Aula
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01_ShellScripting/ResumenUD.html" class="md-nav__link">
        Resumen UD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01_ShellScripting/011_ShellScript_Intro.html" class="md-nav__link">
        1.1- Introducción
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01_ShellScripting/012_ShelScript_Sintaxis.html" class="md-nav__link">
        1.2- Sintaxis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01_ShellScripting/013_ShellScript_ControlFlujo.html" class="md-nav__link">
        1.3- Control de flujo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01_ShellScripting/014_ShellScript_VectoresFunciones.html" class="md-nav__link">
        1.4- Vectores y Funciones
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01_ShellScripting/015_ShellScript_RefuerzoAmpliacion.html" class="md-nav__link">
        1.5- Refuerzo y ampliación
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01_ShellScripting/016_ShellScript_PruebaEspecifica.html" class="md-nav__link">
        1.6- Prueba Auditoria
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          2.- UD2: PowerShell
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="2.- UD2: PowerShell" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          2.- UD2: PowerShell
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02_PowerShell/ProgramacionAula.html" class="md-nav__link">
        Programación de Aula
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02_PowerShell/021_Introduccio%CC%81nPwSh.html" class="md-nav__link">
        2.1- Introducción
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02_PowerShell/022_PowerShell_Sintaxis.html" class="md-nav__link">
        2.2- Sintaxis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02_PowerShell/023_PowerShell_ControlFlujo.html" class="md-nav__link">
        2.3- Control de flujo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02_PowerShell/024_PowerShell_VectoresFunciones.html" class="md-nav__link">
        2.4- Vectores y Funciones
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          3.- UD3: Administración de procesos del sistema
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="3.- UD3: Administración de procesos del sistema" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          3.- UD3: Administración de procesos del sistema
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03_Procesos/ProgramacionAula.html" class="md-nav__link">
        Programación de Aula
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03_Procesos/031_Planificador.html" class="md-nav__link">
        3.1- Introducción Procesos, Planificador
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03_Procesos/032_Hilos.html" class="md-nav__link">
        3.2- Hilos, Sincronización e interrupciones, Herramientas gráficas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03_Procesos/033_GestionProcesosShell.html" class="md-nav__link">
        3.3- Gestión de procesos en Shell de Linux.
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03_Procesos/034_GestionProcesosPWSH.html" class="md-nav__link">
        3.4- Gestión de procesos en PowerShell.
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03_Procesos/035_ArranqueServicios.html" class="md-nav__link">
        3.5- Arranque del sistema. Servicios. Systemd.
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5">
          4.- Servicios de Directorio Libres: LDAP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="4.- Servicios de Directorio Libres: LDAP" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          4.- Servicios de Directorio Libres: LDAP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04_LDAP/ProgramacionAula.html" class="md-nav__link">
        Programación de Aula
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04_LDAP/041_Introduccion_SDyLDAP.html" class="md-nav__link">
        4.1- Introducción Servicios de directorio y LDAP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04_LDAP/042_InstalacionConfigLDAP_PR.html" class="md-nav__link">
        4.2- Instalación y configuración de OpenLDAP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04_LDAP/043_LDAP_DIT.html" class="md-nav__link">
        4.3- Modelo de Información de LDAP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04_LDAP/044_UsersLDAP.html" class="md-nav__link">
        4.4- Creación y comprobación de Usuarios/Grupos OpenLDAP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04_LDAP/045_LDAP_EsquemaHerramientas.html" class="md-nav__link">
        4.5- Esquema LDAP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04_LDAP/046_LDAP_Graficas.html" class="md-nav__link">
        4.6- Gestión usuarios LDAP con GUI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6">
          5.- Servicios de Directorio Propietarios: Active Directory
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="5.- Servicios de Directorio Propietarios: Active Directory" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          5.- Servicios de Directorio Propietarios: Active Directory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="051_ActiveDirectory.html" class="md-nav__link">
        5.1- Introducción Active Directory
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7">
          6.- Integración de sistemas operativos en red libres y propietarios
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="6.- Integración de sistemas operativos en red libres y propietarios" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          6.- Integración de sistemas operativos en red libres y propietarios
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06_INTEGRA/061_ServiciosRedRecursosCompartidos.html" class="md-nav__link">
        6.1- Introducción: Sistemas heterogéneos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06_INTEGRA/062_NFS.html" class="md-nav__link">
        6.2- NFS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06_INTEGRA/063_DockerIntroNextCloud.html" class="md-nav__link">
        6.3- Docker Introducción y NextCloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06_INTEGRA/064_HerramientasDocker.html" class="md-nav__link">
        6.4- Herramientas de Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06_INTEGRA/065_IntroSamba.html" class="md-nav__link">
        6.5- Introducción Samba
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06_INTEGRA/066_SambaSecUsers.html" class="md-nav__link">
        6.6- Secciones y Usuarios Samba
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="instalacion-de-active-directory-i">Instalación de Active Directory I<a class="headerlink" href="#instalacion-de-active-directory-i" title="Permanent link">&para;</a></h1>
<p>Objetivos de esta práctica:</p>
<ul>
<li>Instalar y promocionar un servidor a controlador de dominio</li>
<li>Crear estructuras centralizadas de administración de redes</li>
<li>Unir equipos cliente al dominio</li>
</ul>
<h2 id="creacion-de-un-dominio">Creación de un dominio<a class="headerlink" href="#creacion-de-un-dominio" title="Permanent link">&para;</a></h2>
<p>El primer paso para la creación del Active directory es crear un dominio; en el equipo <strong>Controlador de Dominio</strong>, y debe ser un equipo preparado para aguantar altas cargas de trabajo con una alta disponibilidad, y con un sistema operativo servidor instalado. </p>
<ul>
<li>Para crear un dominio hay que acceder al <strong>Administrador del Servidor</strong> y accedemos a -&gt;  <strong>Agregar Roles y Características</strong>:</li>
</ul>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/001.png" width="900"/>
  <figcaption>Creación de un dominio I.</figcaption>
</figure>

<ul>
<li>Nos aparecerá el asistente para comenzar con la creación del dominio:</li>
</ul>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/002.png" width="900"/>
  <figcaption>Creación de un dominio II.</figcaption>
</figure>

<p>Seleccionaremos una <strong>instalación basada en características y roles</strong>. También podemos hacer una instalación a través de
servicios de acceso remoto, pero en nuestro caso realizaremos la instalación en local.</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/003.png" width="900"/>
  <figcaption>Creación de un dominio III.</figcaption>
</figure>

<p>Una vez seleccionada la <strong>instalación basada en roles</strong>, seleccionaremos nuestro servidor que será donde vamos a instalar
nuestro Active Directory:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/004.png" width="900"/>
  <figcaption>Creación de un dominio IV.</figcaption>
</figure>

<p>Seleccionaremos el rol <strong>Servicios de Dominio de Active Directory</strong>:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/005.png" width="900"/>
  <figcaption>Creación de un dominio V.</figcaption>
</figure>

<p>Y nos aparecerá marcado el rol tal y como muestra la siguiente figura:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/006.png" width="900"/>
  <figcaption>Creación de un dominio VI.</figcaption>
</figure>

<figure>
  <img src="./imagenes/02/PracticasAD/PR04/007.png" width="900"/>
  <figcaption>Creación de un dominio VII.</figcaption>
</figure>

<p>Y procedemos a realizar la instalación. Cuando se agrega un nuevo rol, podemos hacer clic en la opción de reiniciar en caso
de que fuera necesario. En caso que el rol o la característica no fuera necesario un reinicio, no lo haría.</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/008.png" width="900"/>
  <figcaption>Creación de un dominio VIII.</figcaption>
</figure>

<p>Un vez instalado, el asistente nos dice que es necesario realizar una configuración. En este caso hay que promover nuestro
servidor a un servidor de controlador de dominio. Así que haremos clic en la opción de <strong>promover servidor a controlador de
dominio</strong> :</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/009.png" width="900"/>
  <figcaption>Creación de un dominio IX.</figcaption>
</figure>

<p>Ejecutamos el asistente, y las primeras pantallas nos ofrecen información útil para la creación del dominio.</p>
<ul>
<li><strong>Seleccionamos Agregar un nuevo bosque</strong>.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Un conjunto de dominios agrupados lógicamente conforman un árbol de dominios y un conjunto de árboles de dominio agrupados lógicamente conforman un bosque. <strong>En nuestro caso pondremos el dominio ASO2223.LOCAL en lugar de CEFIRE2019.LOCAL como indica en la imagen</strong>:</p>
</div>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/010.png" width="900"/>
  <figcaption>Agregar un nuevo Bosque.</figcaption>
</figure>

<p>A continuación, nos aparece información sobre el nivel funcional del nuevo bosque. Según el nivel funcional que
establezcamos, implementaremos un directorio activo compatible con versiones anteriores de Windows Server, pero más
limitado en cuanto a funciones, o menos compatible con versiones antiguas, pero con mayores funcionalidades. </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>En nuestro caso, seleccionaremos el mayor nivel funcional (<strong>Windows Server 2016</strong>) ya que todos los controladores del dominio tendrán instalado, al menos, <strong>Windows Server 2016</strong>. También añadiremos la contraseña para la restauración de nuestro dominio, por defecto la misma que la del administrador.</p>
</div>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/011.png" width="900"/>
  <figcaption>Creación de un dominio X.</figcaption>
</figure>

<p>La siguiente tarea que llevará a cabo el asistente para la creación del dominio, será preguntar por ciertas opciones adicionales
del servidor, como por ejemplo la <strong>configuración del servicio DNS</strong>. Como en nuestro caso no tenemos DNS, dejaremos que el
asistente cree una zona de DNS para que nuestro dominio pueda funcionar.</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/012.png" width="900"/>
  <figcaption>Creación de un dominio XI.</figcaption>
</figure>

<p>A continuación nos aparece la ubicación donde se guardará los objetos de nuestro AD, es decir, <strong>la base de datos</strong>:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/013.png" width="900"/>
  <figcaption>Creación de un dominio XII.</figcaption>
</figure>

<p>Seguidamente nos muestra las configuraciones que se van a realizar. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Como podéis observar también se puede exportar el script para poder ejecutar los mismos comandos a través de <strong>PowerShell</strong>:</p>
</div>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/014.png" width="900"/>
  <figcaption>Creación de un dominio XIII.</figcaption>
</figure>

<p>En el siguiente paso se muestra un resumen de los <strong>Requisitos previos</strong>:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/015.png" width="900"/>
  <figcaption>Comprobación de requisitos previos.</figcaption>
</figure>

<p>Y finalmente realizaríamos la instalación. Nuestra pantalla de inicio de sesión, ahora será diferente, ya que nos aparece el
dominio al que vamos a iniciar la sesión del usuario:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Nos aparecerá <strong>ASO2223</strong> en lugar de <strong>CEFIRE2019</strong></p>
</div>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/016.png" width="900"/>
  <figcaption>Nueva pantalla inicio de sesión con Dominio.</figcaption>
</figure>

<p>Una vez instalado, podemos iniciar sesión con el Administrador del dominio. Podemos comprobar que en el panel de
Administrador de Servidor aparece nuestro dominio configurado <strong>ASO2223.LOCAL</strong> en lugar de <strong>CEFIRE2019.LOCAL</strong></p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/017.png" width="900"/>
  <figcaption>Comprobación Dominio n Administrador de Servidor.</figcaption>
</figure>

<h1 id="creacion-de-dominio-en-server-core">Creación de dominio en Server Core<a class="headerlink" href="#creacion-de-dominio-en-server-core" title="Permanent link">&para;</a></h1>
<p>Se podría hacer una instalación sin experiencia de escritorio del Windows Server 2019 esto es una instalación mucho más liviana que permite tener un servidor sin entorno gráfico. A esta versión se le conoce como el nombre de <strong>Server Core</strong>. En este punto vamos a mostrar a realizar una instalación de un dominio en una máquina Server Core.</p>
<p>Para hacer la instalación, debemos seleccionar la opción de instalación sin experiencia de escritorio:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/018.png" width="900"/>
  <figcaption>Instalación Server Core.</figcaption>
</figure>

<h2 id="powershell-para-configurar-un-dominio">PowerShell para configurar un dominio<a class="headerlink" href="#powershell-para-configurar-un-dominio" title="Permanent link">&para;</a></h2>
<p>Para configurar el dominio con PowerShell vamos a presentar unos scripts que permitirán realizar la configuración tanto de la máquina como del Active
Directory. Para entrar dentro del shell de PowerShell, teclearemos el comando <strong>powershell</strong> en la consola:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/019.png" width="900"/>
  <figcaption>Entrar al PowerShell en el Server Core.</figcaption>
</figure>

<h3 id="configuracion-inicial">Configuración inicial<a class="headerlink" href="#configuracion-inicial" title="Permanent link">&para;</a></h3>
<p>Primero realizaremos la configuración de la máquina, a través del siguiente script. </p>
<p><code>ConfiguracionInicial.ps1</code>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">$nombreServer=&quot;ASO2223&quot;</span><span class="w"></span>
<span class="linenos" data-linenos="2 "></span><span class="l l-Scalar l-Scalar-Plain">$dirIP=&quot;192.168.5.1X&quot;</span><span class="w"></span>
<span class="linenos" data-linenos="3 "></span><span class="l l-Scalar l-Scalar-Plain">$redInterna=&quot;Ethernet 2&quot;</span><span class="w"></span>
<span class="linenos" data-linenos="4 "></span><span class="l l-Scalar l-Scalar-Plain">Rename-Computer -NewName $nombreServer</span><span class="w"></span>
<span class="linenos" data-linenos="5 "></span><span class="l l-Scalar l-Scalar-Plain">Get-NetAdapter –name $redInterna | Remove-NetIPAddress -Confirm:$false</span><span class="w"></span>
<span class="linenos" data-linenos="6 "></span><span class="l l-Scalar l-Scalar-Plain">Get-NetAdapter –name $redInterna | New-NetIPAddress –addressfamily IPv4 –ipaddress $dirIP –prefixlength 24 –type unicast</span><span class="w"></span>
</code></pre></div></p>
<div class="admonition warming">
<p class="admonition-title">Warming</p>
<p>Después de la captura se debe reiniciar para aplicar los cambios.</p>
</div>
<p><strong>Donde se Puede observar:</strong></p>
<ul>
<li>El nombre de máquina en la variable <code>$nombreServer</code></li>
<li>El adaptador de la red interna en $redInterna (Ejemplo en el script) y también la dirección IP de la red interna en <code>$dirIP</code>. </li>
<li>El comando<code>_Rename-Computer -NewName $nombreServer</code> cambia el nombre del servidor. </li>
<li>Los comandos: <ul>
<li><code>_Get-NetAdapter –__name $redInterna | Remove-NetIPAddress -Confirm:$false</code> </li>
<li><code>_Get-NetAdapter –name $redInterna | New-NetIPAddress –addressfamily IPv4 –ipaddress</code></li>
<li><code>$dirIP –prefixlength 24 –type unicast</code> 
  Nos permiten añadir la dirección IP de nuestra red interna.</li>
</ul>
</li>
<li>Finalmente con <code>_Restart-Computer -force</code> reiniciamos la máquina y tendremos configurado el nombre y el interfaz de la red interna.</li>
</ul>
<h3 id="instalar-controlador-de-dominio-con-powershell">Instalar Controlador de dominio con powershell<a class="headerlink" href="#instalar-controlador-de-dominio-con-powershell" title="Permanent link">&para;</a></h3>
<p>Ahora vamos a promover nuestro servidor a controlador de dominio. Esto también lo vamos a realizar a través de powershell
mediante scripts. </p>
<p><code>creaciondominio.ps1</code>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">$dominioFQDN = &quot;ASO2223CORE.LOCAL&quot;</span><span class="w"></span>
<span class="linenos" data-linenos="2 "></span><span class="l l-Scalar l-Scalar-Plain">$dominioNETBIOS = &quot;ASO2223CORE&quot;</span><span class="w"></span>
<span class="linenos" data-linenos="3 "></span><span class="l l-Scalar l-Scalar-Plain">$adminPass = &quot;aso2223.&quot;</span><span class="w"></span>
<span class="linenos" data-linenos="4 "></span><span class="l l-Scalar l-Scalar-Plain">Install-WindowsFeature AD-Domain-Services,DNS</span><span class="w"></span>
<span class="linenos" data-linenos="5 "></span><span class="l l-Scalar l-Scalar-Plain">Import-module addsdeployment</span><span class="w"></span>
<span class="linenos" data-linenos="6 "></span><span class="l l-Scalar l-Scalar-Plain">Install-ADDSForest -DomainName $dominioFQDN -DomainNetBiosName $dominioNETBIOS -SafeModeAdministratorPassword (ConvertTo-SecureString -string $adminPass -AsPlainText -Force) -DomainMode WinThreshold -ForestMode WinThreshold -InstallDNS -Confirm:$false</span><span class="w"></span>
</code></pre></div></p>
<p><strong>Donde se Puede observar:</strong></p>
<ul>
<li>En la variable <code>_$dominioFQDN_</code> pondremos nuestro nombre de dominio </li>
<li>y en <code>_$dominioNETBIOS_</code> el nombre de dominio NETBIOS. </li>
<li>El comando <code>_Install-WindowsFeature AD-Domain-Services,DNS_</code> instala los roles de AD y también de DNS.</li>
<li>El comando<code>_Install-ADDSForest_</code> realiza la configuración del dominio.</li>
</ul>
<p>Al ejecutarlo mostraría por pantalla:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/020.png" width="900"/>
  <figcaption>Creación de dominio en Server Core.</figcaption>
</figure>

<p>Finalmente reiniciamos la máquina y ya tenemos instalado nuestro controlador de dominio en una máquina core con
powershell. Notad que el inicio de sesión ahora ya es es ASO2223.LOCAL.</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/021.png" width="900"/>
  <figcaption>Nuevo Inicio Sesión en Server Core.</figcaption>
</figure>

<p>Para comprobar que todo se ha configurado de manera correcta, podemos iniciar sesión y ejecutar el comando <strong>sconfig</strong>. Nos
muestra información relativa al nombre de máquina, dominio y algunas otras opciones:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/022.png" width="900"/>
  <figcaption>Utilidad de inspección sconfig.</figcaption>
</figure>

<h3 id="apagado-de-la-maquina">Apagado de la máquina<a class="headerlink" href="#apagado-de-la-maquina" title="Permanent link">&para;</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Para poder apagar la máquina podemos hacer uso del comando <code>shutdown /p</code> o bien a través de la <code>opción 14</code> de la utilidad <code>sconfig</code>.</p>
</div>
<h2 id="unir-clientes-al-dominio">Unir clientes al dominio<a class="headerlink" href="#unir-clientes-al-dominio" title="Permanent link">&para;</a></h2>
<h3 id="anadir-maquinas-clientes-al-dominio">Añadir máquinas clientes al dominio<a class="headerlink" href="#anadir-maquinas-clientes-al-dominio" title="Permanent link">&para;</a></h3>
<p>Para incluir en el dominio los equipos que actuarán como cliente hay que configurar las propiedades de Internet de cada una
de las máquinas que vamos a unir al dominio, teniendo en cuenta que:</p>
<p>La dirección del controlador de dominio (que implementa funciones de DNS) es la 192.168.5.1X. La máscara de subred es de
24 bits. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>En la red que se ha montado <strong>como ejemplo</strong> hay un elemento de interconexión con <strong>IP 192.168.100.1</strong> que implementa las funciones de puerta de enlace y de DNS, por ese motivo se ha incluido como puerta de enlace predeterminada y como DNS secundario, sin embargo estos dos campos no son necesarios si únicamente queremos trabajar en el interior de una única red. Más adelante veremos instalación de un <strong>servicio de DHCP</strong> y el enrutamiento, para que nuestro servidor pueda ofrecer a los clientes de la red interna una dirección de manera dinámica.</p>
</div>
<p>A continuación, en el siguiente ejemplo, se revisa la configuración de la máquina cliente <strong>Windows 10</strong> que vamos a validar en el dominio Windows Server 2019 (utilizaremos la máquina con interfaz gráfica):</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/023.png" width="900"/>
  <figcaption>Configuración red cliente Windows 10.</figcaption>
</figure>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>La figura anterior es un ejemplo de configuración, habrá que adapatarlo al rango utilizado en el Aula.</p>
</div>
<p>Comprobaremos también que desde la máquina cliente podamos hacer ping a nuestro dominio, esto es al dominio
<strong>ASO2223.LOCAL</strong>. Para ello abrimos una terminal en la máquina <strong>Windows 10 (Tecla Windows + R y luego cmd)</strong> y
comprobamos que el ping al dominio funcione. </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Es importante que este ping funcione, en caso contrario no se podrá realizar la validación en nuestro dominio</strong>.</p>
</div>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/024.png" width="900"/>
  <figcaption>ping al dominio.</figcaption>
</figure>

<p>Y ahora sí, ya podemos unir nuestra máquina al dominio. Para ello, en Windows 10, seleccionaremos el botón de inicio y con
el botón de la derecha del ratón, seleccionaremos Sistema:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/025.png" width="900"/>
  <figcaption>Unir cliente windows 10 a dominio I.</figcaption>
</figure>

<p>Seleccionamos Conectar a la red del trabajo o colegio y nos aparecerá la siguiente información:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/026.png" width="900"/>
  <figcaption>Unir cliente windows 10 a dominio II.</figcaption>
</figure>

<p>Hacemos clic en Conectar:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/027.png" width="900"/>
  <figcaption>Unir cliente windows 10 a dominio III.</figcaption>
</figure>

<p>Seleccionamos la opción de Unir este dispositivo a un dominio local de Active Directory. Nos aparecerá una ventana para
introducir el nombre de dominio al que nos queremos conectar:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/028.png" width="900"/>
  <figcaption>Unir cliente windows 10 a dominio IV.</figcaption>
</figure>

<p>En nuestro caso, introduciremos nuestro nombre de nominio, <strong>ASO2223.LOCAL</strong> en lugar de <strong>CEFIRE2019.LOCAL</strong>:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/029.png" width="900"/>
  <figcaption>Unir cliente windows 10 a dominio V.</figcaption>
</figure>

<p>Para poder realizar la validación, hay que introducir la cuenta del Administrador del dominio y su contraseña, en nuestro caso,
será Administrador y como contraseña cefire2019.</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/030.png" width="900"/>
  <figcaption>Unir cliente windows 10 a dominio VI.</figcaption>
</figure>

<p>Seleccionamos que nuestro administrador tenga los privilegios de administrador en la máquina cliente, para ello selecionamos
Tipo Cuenta y marcamos la opción de Administrador. Reiniciamos la máquina y ya tenemos nuestro cliente Windows 10
validado en el dominio.</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/030.png" width="900"/>
  <figcaption>Unir cliente windows 10 a dominio VI.</figcaption>
</figure>

<p>A partir de este momento, ya podemos iniciar sesión con cualquier usuario del dominio. En nuestro caso solo tenemos el
usuario Administrador, podemos probar a iniciar sesión en la máquina con la cuenta del Administrador del dominio.</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/031.png" width="900"/>
  <figcaption>Unir cliente windows 10 a dominio VII.</figcaption>
</figure>

<p>También podemos ver en nuestro servidor, desde el panel del Administrador de Servidor nuestra máquina. Para ello, desde la
máquina Windows Server 2019, accedemos al <strong>Administrador de Servidor --&gt; Herramientas --&gt; Usuarios y Equipos de Active
Directory</strong>:</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/032.png" width="900"/>
  <figcaption>Unir cliente windows 10 a dominio VIII.</figcaption>
</figure>

<p>Seleccionamos nuestro dominio ASO2223.LOCAL y luego Computers. Aparecerá nuestra máquina cliente PC01, si la
seleccionamos, con el botón de la derecha del ratón --&gt; propiedades. Aquí podemos ver alguna información relativa a la
máquina conectada.</p>
<figure>
  <img src="./imagenes/02/PracticasAD/PR04/033.png" width="900"/>
  <figcaption>Unir cliente windows 10 a dominio IX.</figcaption>
</figure>

<h2 id="errores-en-la-union">Errores en la unión<a class="headerlink" href="#errores-en-la-union" title="Permanent link">&para;</a></h2>
<p>En caso de que haya habido algún error en la unión del equipo cliente al dominio se deben comprobar algunos
aspectos:</p>
<ul>
<li>La configuración de la interfaz de red está en modo 'Adaptador puente', no en 'NAT'.</li>
<li>El equipo cliente y el equipo servidor se hallan en la misma red.</li>
<li>El nombre del dominio puede resolverse desde el equipo cliente (ping ASO2223.LOCAL )</li>
<li>La dirección del servidor <strong>DNS</strong> está correctamente configurada en el equipo cliente.</li>
</ul>
<!-- ## Ejercicios

En esta actividad vamos a realizar la configuración de un dominio y la validación de una máquina Windows 10 en el
mismo.

1. **Creación de un dominio**: 

- En este apartado habrá que instalar y configurar un dominio. El dominio que hay que instalar y configurar será **ASO2223.LOCAL**. Para ello habrá que entregar un único archivo PDF con la captura de pantalla de nuestro **Panel de Administrador del Servidor**, donde aparezca claramente el nombre de máquina y también el nombre de dominio.

<figure>
  <img src="./imagenes/02/PracticasAD/PR04/034.png" width="900"/>
  <figcaption>Ejemplo Práctica 05_AD Ejercicio1.</figcaption>
</figure>

2. **Validar una máquina Windows 10 en el dominio**:

- Una vez instalado y configurado el domino, habrá que validar nuestra máquina Windows 10 cliente en el dominio.
Una vez unida al dominio, habrá que añadir al documento a entregar, una captura de pantalla donde se aprecie
en el servidor que el equipo está dado correctamente de alta (**Inicio → Herramientas Administrativas → Usuarios
y Equipos de Active Directory → ASO2223.LOCAL → Computer/Equipos**). Añade también alguna captura de
pantalla de las propiedades del equipo donde se identifique el sistema operativo de los equipos que has unido al
dominio.

<figure>
  <img src="./imagenes/02/PracticasAD/PR04/035.png" width="900"/>
  <figcaption>Ejemplo Práctica 05_AD Ejercicio2.</figcaption>
</figure>
 -->





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2021-2022 Fº Javier Hernández - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["header.autohide", "toc.integrate", "navigation.indexes"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
    
    
  </body>
</html>