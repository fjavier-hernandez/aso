
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://javierhernadez81.github.io/aso2122/072_Samba.html">
      
      <link rel="icon" href="imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>7.2- Samba - Administración de Sistemas Operativos</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    
      

  


  

  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0CPJP88MBF"),document.addEventListener("DOMContentLoaded",function(){"undefined"!=typeof location$&&location$.subscribe(function(t){gtag("config","G-0CPJP88MBF",{page_path:t.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-0CPJP88MBF"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="javi" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#samba" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="index.html" title="Administración de Sistemas Operativos" class="md-header__button md-logo" aria-label="Administración de Sistemas Operativos" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Administración de Sistemas Operativos
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              7.2- Samba
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="javi" data-md-color-primary="" data-md-color-accent=""  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Administración de Sistemas Operativos" class="md-nav__button md-logo" aria-label="Administración de Sistemas Operativos" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    Administración de Sistemas Operativos
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        1.- UD1: ShellScripting
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="1.- UD1: ShellScripting" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          1.- UD1: ShellScripting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="01_ShellScripting/index.html" class="md-nav__link">
        Programación de Aula
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="01_ShellScripting/011_ShellScript_Intro.html" class="md-nav__link">
        1.1- Introducción
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="01_ShellScripting/012_ShelScript_Sintaxis.html" class="md-nav__link">
        1.2- Sintaxis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="01_ShellScripting/013_ShellScript_ControlFlujo.html" class="md-nav__link">
        1.3- Control de flujo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="01_ShellScripting/014_ShellScript_VectoresFunciones.html" class="md-nav__link">
        1.4- Vectores y funciones
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="01_ShellScripting/015_ShellScript_RefuerzoAmpliacion.html" class="md-nav__link">
        1.5- Refuerzo y ampliación
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="01_ShellScripting/016_ShellScript_PruebaEspecifica.html" class="md-nav__link">
        1.6- Prueba Específica
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        2.- UD2: PowerShell
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="2.- UD2: PowerShell" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          2.- UD2: PowerShell
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="02_PowerShell/index.md" class="md-nav__link">
        None
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="02_PowerShell/012_PowerShell.html" class="md-nav__link">
        2.1- PowerShell
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        2.- Administración de servicios de directorio
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="2.- Administración de servicios de directorio" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          2.- Administración de servicios de directorio
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="021_Introduccion_SD.html" class="md-nav__link">
        2.1- Introducción de servicios de directorio
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="022_LDAP.html" class="md-nav__link">
        2.2- LDAP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="023_ActiveDirectory.html" class="md-nav__link">
        2.3- Active Directory
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        3.- Administración de procesos del sistema
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="3.- Administración de procesos del sistema" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          3.- Administración de procesos del sistema
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="031_Planificador.html" class="md-nav__link">
        3.1- Planificación y sincronización de procesos
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="032_GestionProcesos.html" class="md-nav__link">
        3.2- Gestión de los procesos del sistema
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="033_ArranqueServicios.html" class="md-nav__link">
        3.3- Secuencia de arranque del sistema. Demonios y servicios
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        4.- Información del sistema
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="4.- Información del sistema" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          4.- Información del sistema
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="041_EstructuraDirectorios.html" class="md-nav__link">
        4.1- Estructura de directorios
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="042_ArchivosVirtualSWinstaladoRendimiento.html" class="md-nav__link">
        4.2- VFS, Sw Instalado y Gestión Rendimiento
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="043_Planificacio%CC%81nTareas.html" class="md-nav__link">
        4.3- Planificación de Tareas
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        5.- Servicios de acceso y administración remota
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="5.- Servicios de acceso y administración remota" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          5.- Servicios de acceso y administración remota
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="051_AccesoRemotoLinux.html" class="md-nav__link">
        5.1- Acceso Remoto en modo texto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="052_EscritorioRemoto.html" class="md-nav__link">
        5.2- Escritorio Remoto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="053_HerramientasGraficAdminRemota.html" class="md-nav__link">
        5.3- Herramientas gráficas externas.
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        6.- Administración de Servidores de Impresión
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="6.- Administración de Servidores de Impresión" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          6.- Administración de Servidores de Impresión
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="061_ServidoresImpresion.html" class="md-nav__link">
        6.1- Servidores de Impresión
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="062_ServidoresImpresionLinux.html" class="md-nav__link">
        6.2- Servidor de impresión en GNU/Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="063_ServidorImpresionWindowsServer.html" class="md-nav__link">
        6.3- Servidor de impresión en Windows Server
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" checked>
      
      <label class="md-nav__link" for="__nav_9">
        7.- Integración de sistemas operativos en red libres y propietarios
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="7.- Integración de sistemas operativos en red libres y propietarios" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          7.- Integración de sistemas operativos en red libres y propietarios
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="071_ServiciosRedRecursosCompartidos.html" class="md-nav__link">
        7.1- Servicios de red para compartir recursos
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          7.2- Samba
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="072_Samba.html" class="md-nav__link md-nav__link--active">
        7.2- Samba
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuracion-del-servicio-samba" class="md-nav__link">
    Configuración del servicio SAMBA
  </a>
  
    <nav class="md-nav" aria-label="Configuración del servicio SAMBA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fichero-configuracion" class="md-nav__link">
    Fichero Configuración
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creacion-directorio-compartido" class="md-nav__link">
    Creación Directorio Compartido
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integracion-de-permisos-gnulinux-microsoft-windows" class="md-nav__link">
    Integración de permisos GNU/Linux – Microsoft Windows
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#administracion-de-permisos-con-rsat" class="md-nav__link">
    Administración de permisos con RSAT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#perfiles-de-usuario-y-carpetas-personales" class="md-nav__link">
    Perfiles de usuario y carpetas personales
  </a>
  
    <nav class="md-nav" aria-label="Perfiles de usuario y carpetas personales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#perfiles" class="md-nav__link">
    Perfiles
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cuotas-de-disco" class="md-nav__link">
    Cuotas de disco
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades-iniciales-ud7" class="md-nav__link">
    Actividades Iniciales UD7
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades-de-desarrollo-ud7_01" class="md-nav__link">
    Actividades de desarrollo UD7_01
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades-de-desarrollo-ud7_02" class="md-nav__link">
    Actividades de desarrollo UD7_02
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="073_NFS.html" class="md-nav__link">
        7.3- NFS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="074_NextCloud.html" class="md-nav__link">
        7.4- NextCloud
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <figure style="float: right;">
    <img src="imagenes/07/072/001.png" width="200"/>
</figure>

<h1 id="samba">SAMBA<a class="headerlink" href="#samba" title="Permanent link">&para;</a></h1>
<h2 id="configuracion-del-servicio-samba">Configuración del servicio SAMBA<a class="headerlink" href="#configuracion-del-servicio-samba" title="Permanent link">&para;</a></h2>
<p>Como ya se ha visto con anterioridad, <strong>Samba</strong> es un conjunto de aplicaciones para GNU/Linux que implementan el protocolo de comunicación <em>SMB</em> utilizado por <em>Microsoft Windows</em> para compartir carpetas e impresoras. </p>
<ul>
<li>Permite a sistemas GNU/ Linux compartir carpetas como si de un sistema <em>Microsoft Windows</em> se tratara.</li>
</ul>
<p>En un servidor de archivos, el acceso a una carpeta puede estar determinado por dos conjuntos de entradas de permisos:</p>
<ul>
<li>los permisos de <strong>recurso compartido</strong> definidos tan solo a <strong>carpetas</strong>.</li>
<li>los permisos de red o <strong>NTFS</strong> (<em>New Technology File System</em>) definidos tanto en <strong>carpetas</strong> como en <strong>archivos</strong>.</li>
</ul>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<p>En sistemas operativos basados en GNU/Linux la gestión de los grupos y privilegios se hace a través de los comandos <strong>samba-tool user</strong> y <strong>samba-tool group</strong>.</p>
</div>
<ul>
<li>
<p>Los permisos de <strong>recurso compartido</strong> suelen utilizarse para administrar equipos con sistemas de archivos <strong>FAT32</strong> (<em>File Allocation Table</em>) o posterior, por lo que quedan desterrados en sistemas operativos de red. </p>
</li>
<li>
<p>Con la aparición del sistema de archivos <strong>NTFS</strong> (<em>New Technology File System</em>), se incluyeron nuevos tipos de permisos asignables a carpetas, y además, también a ficheros. </p>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title"><strong>A tener en cuenta</strong></p>
<p>Ambos sistemas de permisos conviven en entornos de <em>Microsoft</em> por lo que será en el tema dedicado a ello cuando entraremos en detalle.</p>
</div>
<h3 id="fichero-configuracion">Fichero Configuración<a class="headerlink" href="#fichero-configuracion" title="Permanent link">&para;</a></h3>
<p>Toda la configuración de <em>Samba</em> se encuentra en el fichero <strong>/etc/samba/smb.conf</strong> &#8594; <a href="http://manpages.ubuntu.com/manpages/bionic/man5/smb.conf.5.html">DOCUMENTACIÓN OFICIAL</a> .</p>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<p>Existen multitud de opciones pero tan solo se analizarán las imprescindibles para la compartición de recursos. Las líneas que comiencen con <strong>#</strong> o <strong>;</strong> están comentadas y el servicio no las tendrá en cuenta. </p>
</div>
<p><strong>Este fichero tiene varios apartados, con opciones que se comentarán a continuación:</strong></p>
<ul>
<li><strong>[global],</strong> se especifican opciones generales:</li>
</ul>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>workgroup</strong></td>
<td>Esta variable ha de almacenar el nombre del grupo de trabajo o dominio que usamos en nuestra red.</td>
</tr>
<tr>
<td><strong>server string</strong></td>
<td>Permite reconocer el equipo dentro del dominio. Por defecto tiene como valor el nombre del servidor.</td>
</tr>
<tr>
<td><strong>hosts allow</strong></td>
<td>Especifica desde qué direcciones IP se podrá acceder al servicio. Si se especifica  192.168. todas las direcciones que empiecen de ese modo tendrán acceso al recurso. Se puede establecer direcciones IP completas.</td>
</tr>
<tr>
<td><strong>hosts deny</strong></td>
<td>Especifica los rangos no permitidos, del mismo modo que <strong>host allow</strong>.</td>
</tr>
<tr>
<td><strong>security,</strong></td>
<td>Especifica el nivel de seguridad con el que se puede acceder.</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>[autentication]</strong>, donde se destaca <strong>server role</strong> &#8594; indica la forma en la que va a trabajar el servidor <em>Samba</em>:</li>
</ul>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>standalone server</strong></td>
<td>Modo por defecto, actúa como un servidor de ficheros y directorios compartidos pero no como servidor de dominio.</td>
</tr>
<tr>
<td><strong>member server</strong></td>
<td>similar al anterior con la diferencia que añadimos al equipo a un dominio ya existente y por tanto su funcionamiento se verá afectado por las reglas de éste. Esta opción requiere añadir las líneas <strong>security=ADM</strong>, para indicar que el control de acceso lo gestionará el  controlador de dominio, y <strong>realm =NOMBREDOMINIO.COM</strong> para indicar el nombre de dominio al que pertenece el servidor. Además, hay que comentar la línea <strong>workgroup</strong> ya que no pertenecemos a un grupo de trabajo.</td>
</tr>
<tr>
<td><strong>AD domain controler</strong></td>
<td>actúa como un controlador de dominio.</td>
</tr>
</tbody>
</table>
<h3 id="creacion-directorio-compartido">Creación Directorio Compartido<a class="headerlink" href="#creacion-directorio-compartido" title="Permanent link">&para;</a></h3>
<ul>
<li>Para crear un directorio compartido es necesario añadir una nueva sección del siguiente modo:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p p-Indicator">[</span><span class="nv">compartidoUser1</span><span class="p p-Indicator">]</span>
<span class="linenos" data-linenos="2 "></span><span class="l l-Scalar l-Scalar-Plain">comment = Carpeta compartida</span> 
<span class="linenos" data-linenos="3 "></span><span class="l l-Scalar l-Scalar-Plain">path = /media/compartido/user1</span>
<span class="linenos" data-linenos="4 "></span><span class="l l-Scalar l-Scalar-Plain">guest ok = Yes</span>
<span class="linenos" data-linenos="5 "></span><span class="l l-Scalar l-Scalar-Plain">read only = Yes</span>
<span class="linenos" data-linenos="6 "></span><span class="l l-Scalar l-Scalar-Plain">write list = @Ceos, administrador, user1 directory mask = 0755</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<ul>
<li>Estas  líneas  crean  un  recurso  compartido  con  el  nombre <strong>compartidoUser1</strong>  en  el  directorio <strong>/media/compartido/user1</strong> de solo lectura, con acceso de invitado, los usuarios <strong>administrador</strong> y <strong>user1</strong> pueden escribir  y el grupo <strong>@Ceos</strong> también. </li>
<li>Además, se aplicará una máscara de permisos automática de 0755 a los ficheros y carpetas que se creen en este recurso.</li>
</ul>
</div>
<ul>
<li>Las opciones más relevantes son:</li>
</ul>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>guest ok</strong></td>
<td>Permite el acceso como usuario invitado. Su valor puede ser <strong>Yes</strong> o <strong>No</strong>.</td>
</tr>
<tr>
<td><strong>public</strong></td>
<td>Equivalente del parámetro <strong>guest ok</strong>.</td>
</tr>
<tr>
<td><strong>browseable</strong></td>
<td>Permitirá mostrar este recurso en las listas de recursos compartidos. Su valor puede ser <strong>Yes</strong> o <strong>No</strong>.</td>
</tr>
<tr>
<td><strong>writable</strong></td>
<td>Permitirá la escritura. Su valor puede ser <strong>Yes</strong> o <strong>No</strong>.</td>
</tr>
<tr>
<td><strong>valid users</strong></td>
<td>Especifica qué usuarios o grupos pueden acceder al recurso compartido. Mirar valores en la Nota a continuación de esta tabla.</td>
</tr>
<tr>
<td><strong>write list</strong></td>
<td>Usuarios o grupos pueden acceder con permiso de escritura.</td>
</tr>
<tr>
<td><strong>admin users</strong></td>
<td>Usuarios o grupos pueden acceder con permisos administrativos.</td>
</tr>
<tr>
<td><strong>directory mask</strong></td>
<td>Define que permisos en el sistema tendrán los subdirectorios creados dentro del recurso.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA: valores <code>valid users</code></strong></p>
<ul>
<li>nombres de usuarios separados por comas</li>
<li>nombres de grupo precedidos por una <em>@</em></li>
<li><strong>%S</strong> indica que solo el usuario cuyo nombre sea igual al de ese directorio, tiene acceso (útil para las carpetas personales de usuario)</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title"><strong>A tener en cuenta</strong></p>
<ul>
<li>Una vez añadido el recurso, es necesario reiniciar el servicio para que se apliquen los cambios</li>
</ul>
</div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">/etc/init.d/smbd restart</span>
</code></pre></div>
<ul>
<li>Por último, para acceder al recurso se realizará a través de cualquier navegador de archivos usando el protocolo <strong>smb</strong> especificando el usuario, la dirección del recurso y su nombre del siguiente modo:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">smb://usuario1@servidorubuntu/compartido1</span>
</code></pre></div>
<h2 id="integracion-de-permisos-gnulinux-microsoft-windows">Integración de permisos <strong>GNU/Linux</strong> – <strong>Microsoft Windows</strong><a class="headerlink" href="#integracion-de-permisos-gnulinux-microsoft-windows" title="Permanent link">&para;</a></h2>
<p>Para poder utilizar los permisos <strong>NTFS</strong> en <em>GNU/Linux</em> es necesario realizar una serie de configuraciones descritas en el siguiente apartado. <strong>Esto permitirá integrar de forma transparente ambos sistemas</strong>.</p>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<p>La administración de los permisos en <em>Ubuntu Server</em> se realizan a través del conjunto de herramientas de <strong>samba-tool</strong>, en concreto <strong>dsacl</strong> y <strong>ntacl</strong>.  </p>
</div>
<p><strong>Hay que tener en cuenta varias cosas antes de usar los permisos NTFS en <em>Ubuntu Server</em>:</strong></p>
<ul>
<li>El volumen que contenga el recurso compartido debe disponer de las opciones <strong>acl</strong> durante su montaje. Estas opciones serán indicadas en el fichero <code>/etc/fstab</code> para automatizar el proceso.</li>
<li>Si el sistema de ficheros del volumen no es <strong>ext4</strong>, será necesario la instalación de esta característica. En <strong>ext4</strong> viene integrada por defecto.</li>
<li>los permisos que se apliquen a un recurso a través de <em>Samba</em> solo serán válidos a través de este servicio, por lo que se desaconseja el acceso en local al controlador de <em>Active Directory</em>.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title"><strong>A tener en cuenta</strong></p>
<p>Será necesario ahora <strong>ampliar los permisos</strong>  que GNU/Linux establece a los ficheros para que sean compatibles con los de NTFS de <em>Microsoft Windows</em>. Ya que se quiere integrar este servido en una estructura de <em>Active Directory</em> será necesario que los permisos asignados a los ficheros sean entendibles por los clientes <em>Microsoft Windows</em> que accedan a este servidor.</p>
</div>
<ul>
<li>Para ello se necesita instalar dos paquetes el <strong>attr</strong> y el <strong>acl</strong> que juntos compatibilizan las listas de control de acceso entre ambos sistemas.</li>
</ul>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<p>La parte interesante de estos paquetes es que esta ampliación de permisos se le puede asignar a tan un medio determinado o a todo el sistema, <strong>por lo que ambos permisos de acceso pueden convivir sin conflicto alguno</strong>.</p>
</div>
<p>Los pasos para realizar los dos aspectos comentados son:</p>
<ol>
<li>A continuación, se debe instalar <strong>un segundo disco duro en el servidor</strong>. Se convertirá este disco duro en un volumen y se destinará a almacenar los ficheros compartidos del servidor, por lo tanto, será a este volumen al que se le asignará la nueva configuración de permisos. </li>
</ol>
<p>Para realizar esta tarea, seguiremos estos pasos:</p>
<ul>
<li>Se añadirá un disco duro <strong>SATA</strong> a la máquina virtual de <strong>1 TB</strong> de capacidad.</li>
<li>Se asignará una partición primaria que ocupe el disco entero.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">sudo fisk /dev/sdb</span>
</code></pre></div>
<ul>
<li>Es necesario asignar un sistema de ficheros, en este caso <strong>ext4</strong> </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">sudo mkfs -t ext4 /dev/sdb1</span>
</code></pre></div>
<ul>
<li>Debe crearse un punto de montaje en <strong>/media/datos</strong>.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">sudo mount /dev/sdb1 /media/datos</span>
</code></pre></div>
<ol start="2">
<li>Otra acción a llevar a cabo es hacer el montaje del nuevo volumen de forma automática al iniciar el sistema. Pare ello será necesario incluir esta información en el fichero <strong>/etc/fstab</strong>:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">/dev/sdb1 /media/datos ext4 defaults 0 0</span>
</code></pre></div>
<ol start="3">
<li>Ahora se instalarán los paquetes necesarios para la asignación de los nuevos permisos:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">sudo apt-get install acl attr</span>
</code></pre></div>
<ol start="4">
<li>Una vez terminada la instalación, se asignará la ampliación de permisos a este nuevo volumen añadiendo <strong>user_xattr,acl,barrier=1</strong> al fichero <strong>/etc/fstab</strong>. Debe quedar de la siguiente manera:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">/dev/sdb1 /media/datos ext4 user\_xattr,acl,barrier=1,defaults 0 0</span>
</code></pre></div>
<ol start="5">
<li>Por último se comprueba que todo ha ido bien reiniciando el equipo y accediendo a la carpeta <strong>/media/datos</strong>.</li>
</ol>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<p>Antes de administrar los permisos de un recurso compartido en un servicio <em>Active Directory</em> con <em>Samba</em>, será necesario su creación y compartición. Esta tarea se realiza añadiendo el recurso al fichero <code>/etc/samba/smb.conf</code>.</p>
</div>
<p>El aspecto que tiene este fichero es el siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="l l-Scalar l-Scalar-Plain">\# Global parameters</span>
<span class="linenos" data-linenos=" 2 "></span><span class="l l-Scalar l-Scalar-Plain">[global]</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="l l-Scalar l-Scalar-Plain">dns forwarder = 8.8.8.8</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="l l-Scalar l-Scalar-Plain">netbios name = SERVIDORUBUNTU</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="l l-Scalar l-Scalar-Plain">realm = MIEMPRESA.LOCAL</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="l l-Scalar l-Scalar-Plain">server role = active directory domain controller workgroup = MIEMPRESA idmap\_ldb:use rfc2307 = yes</span>
<span class="linenos" data-linenos=" 7 "></span><span class="l l-Scalar l-Scalar-Plain">[netlogon]</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="l l-Scalar l-Scalar-Plain">path = /var/lib/samba/sysvol/miempresa.local/scripts read only = No</span>
<span class="linenos" data-linenos=" 9 "></span><span class="l l-Scalar l-Scalar-Plain">[sysvol]</span>
<span class="linenos" data-linenos="10 "></span>    <span class="l l-Scalar l-Scalar-Plain">path = /var/lib/samba/sysvol</span>
<span class="linenos" data-linenos="11 "></span>    <span class="l l-Scalar l-Scalar-Plain">read only = No</span>
</code></pre></div>
<ul>
<li>Tanto <strong>netlogon</strong> como <strong>sysvol</strong> son recursos compartidos que han sido creados durante el proceso de instalación del directorio, y por tanto, son necesarios para el correcto funcionamiento del sistema. Será aquí dónde se crearán los nuevos recursos</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p p-Indicator">[</span><span class="nv">compartido</span><span class="p p-Indicator">]</span>
<span class="linenos" data-linenos="2 "></span>    <span class="l l-Scalar l-Scalar-Plain">path = /media/datos</span> 
<span class="linenos" data-linenos="3 "></span>    <span class="l l-Scalar l-Scalar-Plain">read only = No</span>
</code></pre></div>
<p>Una vez guardado el fichero de configuración, se reinicia el servicio <em>Samba</em> para que los cambios tengan efecto</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">service smbd stop</span>
<span class="linenos" data-linenos="2 "></span><span class="l l-Scalar l-Scalar-Plain">service smbd start</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<p>A partir de este momento, el recurso <strong>/media/datos</strong> está accesible desde <em>Samba</em>, aunque sin ningún tipo de restricción.</p>
</div>
<ul>
<li>
<p>Será necesario ahora el acceso a esta carpeta desde <strong>RSAT</strong> con una cuenta de administración para modificar los permisos de acceso, de igual forma como se realiza en una carpeta compartido en un controlador de domino con <em>Microsoft Windows</em>.</p>
</li>
<li>
<p>A medida que se vayan cambiado los permisos de este recurso a través de <strong>RSAT</strong>, será posible consultarlos desde el terminal con el subcomando <strong>ntacl</strong> o directamente con el comando <strong>getfacl</strong></p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">samba-tool ntacl get /media/datos</span>
</code></pre></div>
<ul>
<li>El cual ofrece información detallada de los permisos o que ofrecerá información de los permisos a modo de resumen.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">getfacl /media/datos</span>
</code></pre></div>
<h2 id="administracion-de-permisos-con-rsat">Administración de permisos con <strong>RSAT</strong><a class="headerlink" href="#administracion-de-permisos-con-rsat" title="Permanent link">&para;</a></h2>
<p>A pesar de la existencia de las herramientas ofrecidas por <em>Samba</em>, la gestión de los permisos de carpetas se realizará con <strong>RSAT</strong>. </p>
<ul>
<li><strong>RSAT</strong> <strong>(<em>Remote Server Administration Tools</em>) es</strong> una aplicación cuyo objetivo es administrar el servidor pensada para instalarse en clientes que replica las herramientas disponibles en el controlador del dominio. </li>
<li>Este <em>software</em> está idealmente pensado para servidores tipo <strong>CORE</strong> en los que no existe una GUI y toda su administración queda adscrita a un terminal. El consumo de recursos de la GUI queda traspasada al cliente. </li>
</ul>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<p>Es preciso señalar que cualquier usuario con permiso para instalar <em>software</em> podrá realizar estas acciones, pero en ningún caso administrar el servidor.</p>
</div>
<figure>
  <img src="./imagenes/07/072/002.png" width="650"/>
  <figcaption>Actualización del sistema con el añadido de RSAT.</figcaption>
</figure>

<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<ul>
<li>Esta tarea es más efectiva y concisa desde el GUI ya que no será necesario recordar todos los usuarios ni grupos creados en el directorio mientras se configuran los permisos. </li>
<li>En efecto, el uso de GUI para la asignación de permisos facilita esta tarea que, en CLI, puede llegar a complicarse en demasía. Por este motivo se utilizará la administración remota que funciona de igual modo que en sistemas operativos de <em>Microsoft</em>.</li>
</ul>
</div>
<ul>
<li>Para poder utilizar <strong>RSAT</strong> será necesario <strong>iniciar sesión como administrador del dominio o una cuenta que disponga de permisos suficientes</strong>. No obstante, por coherencia del proceso, se realizará todo con la cuenta de administrador de dominio.</li>
</ul>
<p>Se inicia sesión en el cliente con la cuenta de administrador de dominio, descargar la versión correcta y se instala el programa. En realidad lo que hace este programa es añadir una herramienta al sistema operativo, como si de una actualización del mismo se tratase. Para ello hay que dirigirse a  <code>Inicio</code> &#8594; <code>Configuración</code> &#8594;  <code>Aplicaciones</code> &#8594;  <code>Características Opcionales</code> &#8594;  <code>Agregar una característica</code> &#8594;  <code>RSAT: Administrador del servidor</code> y pulsar el botón de  <code>Instalar</code>.</p>
<p>Tras el proceso de instalación y el pertinente reinicio, se comprueba que en el menú de  Inicio existe una nueva aplicación denominada <strong>Administrador del servidor</strong> y que la interfaz gráfica de esta herramienta es exactamente igual que la de <em>Microsoft Windows Server</em>. De esta forma será más sencillo el cambio entre una y otra forma de administrar el servidor.</p>
<p>El siguiente paso es conectar esta herramienta con el servidor que se debe administrar. Si en la infraestructura de red existe más de uno, es posible tener una de estas herramientas para cada uno, eso sí, en diferentes clientes.</p>
<p>Para enlazar esta herramienta con el servidor se pulsa el botón derecho sobre la opción  <code>Todos los servidores</code> →  <code>Agregar servidores</code> del panel de la izquierda</p>
<figure>
  <img src="./imagenes/07/072/003.png" width="650"/>
  <figcaption>Añadir el servidor a administrar al RSAT.</figcaption>
</figure>

<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<p>A partir de este momento toda la gestión realizada en esta herramienta tendrá su efecto en el controlador de dominio configurado.</p>
</div>
<h2 id="perfiles-de-usuario-y-carpetas-personales">Perfiles de usuario y carpetas personales<a class="headerlink" href="#perfiles-de-usuario-y-carpetas-personales" title="Permanent link">&para;</a></h2>
<p>Habitualmente los usuarios trabajan con la misma máquina, pero hay ocasiones en las que es necesario que cambien su ubicación de trabajo. Es buena idea entonces que el perfil de ese usuario viaje con él, ya que éste contiene gran parte de la información de trabajo.</p>
<p>El fichero <strong>/etc/profile</strong> contiene la estructura de los perfiles. Además, durante el proceso de creación de perfiles, consulta los <em>scripts</em> ubicados en la carpeta <strong>/etc/profile.d</strong> que también ejecutará durante la creación de un usuario.</p>
<p>Dentro de cada perfil es posible encontrar la siguiente información:</p>
<ul>
<li><strong>Configuración local</strong>, que contiene datos de programa, historial y archivos temporales</li>
<li><strong>Datos de programa</strong>, configuraciones especificas de software de cada usuario, archivos, carpetas, accesos directos, escritorio documentos y plantillas de usuario</li>
<li><strong>Configuración de inicio</strong>, elementos del menú Inicio del usuario así como aplicaciones</li>
</ul>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<p>No es de extrañar que si un usuario cambia de equipo y crea un nuevo perfil, eche de menos toda esta información y, aún peor, no pueda desempeñar su trabajo con normalidad.</p>
</div>
<h3 id="perfiles">Perfiles<a class="headerlink" href="#perfiles" title="Permanent link">&para;</a></h3>
<p>Existen diferentes tipos de perfiles, aunque en este tema se trabajará con los siguientes:</p>
<ul>
<li><strong>Perfiles locales</strong>, creados en un equipo cuando un usuario inicia sesión. El perfil es específico de un usuario y se almacena en el disco duro del equipo local.</li>
<li><strong>Perfiles móviles</strong>, creados por un administrador y almacenados en un servidor. Estos perfiles siguen al usuario a cualquier máquina donde éste inicie sesión.</li>
</ul>
<h4 id="perfiles-locales">Perfiles locales<a class="headerlink" href="#perfiles-locales" title="Permanent link">&para;</a></h4>
<p>Los perfiles locales se crean en los equipos cuando los usuarios inician sesión. En GNU/Linux, los perfiles de usuario se crean en la carpeta <strong>/home/$USER</strong>, con la excepción del usuario <strong>root</strong>, que por motivos de seguridad posee su propio perfil en la ruta <strong>/root</strong>. </p>
<p>Toda la información referida al usuario se encuentra en el directorio <strong>/home/$USER</strong>. Cuando se accede con usuarios distintos, tanto el usuario local como el usuario de red dispondrán de diferentes perfiles.</p>
<h4 id="perfiles-moviles">Perfiles móviles<a class="headerlink" href="#perfiles-moviles" title="Permanent link">&para;</a></h4>
<p>Un perfil móvil <strong>se almacena en un servidor</strong> y, después de que el inicio de sesión del usuario sea autentificado, se copia al equipo local. Esto permite al usuario tener el mismo escritorio, la configuración de las aplicaciones y la configuración local en cualquier máquina. Al cerrar la sesión, el perfil se almacena tanto localmente como en la ubicación de la ruta de acceso al perfil del usuario.</p>
<ul>
<li>Cuando el usuario inicia sesión de nuevo, el perfil del servidor se compara con la copia en el equipo local y se carga la versión más reciente. Si el servidor no esta disponible, se utiliza la copia local. </li>
<li>Si el servidor no esta disponible y es la primera vez que el usuario ha iniciado sesión en el equipo se crea un perfil de usuario localmente utilizando la configuración por defecto.</li>
</ul>
<p><strong>Para configurar un perfil móvil simplemente hay que completar las siguientes acciones:</strong></p>
<ol>
<li>crear una <strong>carpeta compartida</strong> en el servidor para los perfiles.</li>
<li>asignar en la cuenta de usuario una <strong>ruta de acceso</strong> a la carpeta compartida.</li>
</ol>
<p>Una vez realizadas estas acciones, el perfil de usuario se copia en el servidor y estará disponible para el usuario desde cualquier equipo.</p>
<p>Para poder acceder desde un equipo a una carpeta compartida por <strong>nfs</strong> en un servidor, será necesario instalar los paquetes <code>portmap</code> y <code>nfs-common</code> en el cliente</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">sudo apt-get install portmap nfs-common</span>
<span class="linenos" data-linenos="2 "></span><span class="l l-Scalar l-Scalar-Plain">sudo /etc/init.d/portmap restart</span>
</code></pre></div>
<p>Cuando finalice la instalación será posible utilizar el sistema <strong>nfs</strong> como un nuevo sistema de ficheros de red, lo que permitirá gestionar carpetas remotas como si fuesen propias del sistema local.</p>
<p>Ahora es posible montar la carpeta compartida en nuestro sistema de archivos. De esta manera, el acceso es exactamente igual que a cualquier otra carpeta del disco duro local.</p>
<p>En el servidor existe la carpeta compartida <strong>/datos/usuarios/usuario1</strong> con los datos del usuario <code>usuario1</code>. Es posible montar esa carpeta como si fuera una más del sistema de ficheros local</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">sudo mount -t nfs ip-del-servidor:/home/MIEMPRESA.LOCAL/usuario1/datos</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<p>A  partir  de  este  momento  la  carpeta  datos  contiene  la  información  de  la  carpeta <strong>/datos/usuarios/usuario1</strong> del servidor.</p>
</div>
<p>Como ya se ha estudiado, es posible que el sistema monte de forma automática una carpeta compartida por <strong>nfs</strong> al iniciar sesión a través del archivo <strong>/etc/fstab</strong></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">ip-del-servidor:/home/MIEMPRESA.LOCAL/usuario1/datos nfs</span>
</code></pre></div>
<p>Del mismo modo que se ha creado un recurso de red para contener el perfil del usuario, es <strong>posible repetir estos pasos para crear una carpeta personal a cada usuario</strong>.</p>
<p>Para esta tarea se utilizará el servicio <em>Samba</em>, aunque es posible realizarla también con el protocolo <strong>nfs</strong>. Para ello habrá que crear un recurso para cada usuario del siguiente modo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p p-Indicator">[</span><span class="nv">usuario1</span><span class="p p-Indicator">]</span>
<span class="linenos" data-linenos="2 "></span><span class="l l-Scalar l-Scalar-Plain">comment = Carpeta con acceso exclusivo para usuario1 path = /media/usuarios/usuario1</span>
<span class="linenos" data-linenos="3 "></span><span class="l l-Scalar l-Scalar-Plain">guest ok = No</span>
<span class="linenos" data-linenos="4 "></span><span class="l l-Scalar l-Scalar-Plain">public = No</span>
<span class="linenos" data-linenos="5 "></span><span class="l l-Scalar l-Scalar-Plain">read only = Yes</span>
<span class="linenos" data-linenos="6 "></span><span class="l l-Scalar l-Scalar-Plain">write list = %S</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<p>La última línea del la configuración limita el acceso al recurso al usuario que se llame igual que el nombre de la carpeta.</p>
</div>
<h2 id="cuotas-de-disco">Cuotas de disco<a class="headerlink" href="#cuotas-de-disco" title="Permanent link">&para;</a></h2>
<p>Las cuotas de disco permiten controlar la <strong>cantidad de ficheros que se introducen en un recurso compartido</strong>. El espacio de almacenamiento de un servidor es finito y, aunque no lo parezca, si se estrangula uno de los volúmenes, es un tarea costosa asignar nuevo espacio o simplemente no es posible. Con la herramienta <strong>Administración de cuotas</strong>, se pueden realizar las siguientes tareas:</p>
<ul>
<li>Crear cuotas para limitar el espacio asignado a un volumen o carpeta y generar notificaciones cuando se esté a punto de alcanzar o superar el límite de dichas cuotas</li>
<li>Generar cuotas automáticas aplicables a todas las carpetas existentes en un volumen o una carpeta y a todas las subcarpetas que se creen</li>
<li>Definir plantillas de cuota que puedan aplicarse fácilmente a nuevos volúmenes o carpetas y que puedan utilizarse en toda una organización</li>
</ul>
<p>En los sistemas operativos basados en GNU/Linux es posible establecer límites de almacenamiento por usuario e incluso por grupo de usuarios. Es factible establecer cuotas con dos enfoques diferentes:</p>
<ol>
<li>Es posible <strong>limitar el número de bloques</strong> de disco, con lo que se limita el tamaño en disco del que el usuario dispone, tal y como ocurría en <em>Microsoft Windows Server</em>, </li>
<li>Por otro lado, se puede limitar el <strong>número de <em>nodos-i</em></strong>, lo que establece un límite de ficheros por usuario, independientemente del espacio que ocupen</li>
</ol>
<p>Además se puede fijar dos tipos de límites, el <strong>rígido</strong> o <em>hard</em> que impide que el límite sea sobrepasado, y el <strong>flexible</strong> o <em>soft</em> que no limita el espacio en disco pero sí avisa al administrador que se han excedido ciertos límites.</p>
<p>Desde la versión 14.04 de <em>Ubuntu Server</em> el  <em>kernel</em> viene preparado para soportar cuotas de disco, por lo que tan solo será necesario la instalación del paquete que permite gestionar las cuotas: <strong>quota</strong>  y <strong>quotatool</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">sudo apt-get install quota quotatool</span>
</code></pre></div>
<p>Al igual que ocurría en el caso anterior, las cuotas han de ser activadas para cada uno de los volúmenes del sistema. Para ello es necesario especificarlo en las opciones del fichero <strong>/etc/fstab</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">/dev/sdb1 /media/Datos ext4 defaults,usrquota,grpquota    0   0</span>
</code></pre></div>
<p>En las opciones de montaje se han añadido las opciones de <strong>usrquota</strong> y <strong>grpquota</strong>, que permitirán la asignación de cuotas de disco tanto a usuarios como  a  grupos  respectivamente.   Para  que  los  cambios tengan  efecto,  se monta y desmonta el volumen aplicando la nueva configuración especificada en el fichero <strong>/etc/fstab</strong></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">sudo mount -o remount,rw /media/Datos</span>
</code></pre></div>
<p>La unidad ya está preparada para contener cuotas de disco, por lo que será preciso crearlas a través de los comandos que se han instalado: <strong>quotacheck</strong>, <strong>edquota</strong> y <strong>repquota</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">sudo quotacheck -cgu /media/Datos</span>
</code></pre></div>
<p>El comando anterior activa las cuotas para el volumen. La opción <strong>-c</strong> crea los ficheros de configuración necesarios para guardar la información de las cuotas, mientras que las opciones <strong>-u</strong> y <strong>-g</strong> activan las cuotas de usuario y grupo respectivamente. </p>
<p>Si todo ha ido bien, en la carpeta raíz del volumen montado aparecerán dos ficheros <strong>aquota.group</strong> y <strong>aquota.user</strong> que contendrán la configuración de las cuotas para los usuarios y grupos. No se trata de archivos de texto plano como es habitual, sino que estarán cifrados.</p>
<p>Para añadir una cuota a un usuario se utiliza el comando</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">edquota -u administrador</span>
</code></pre></div>
<p>Aparecerá en pantalla el editor de texto predeterminado junto con la configuración del usuario especificado</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">Disk quotas dor user administrador (uid 1000)</span><span class="p">:</span>
<span class="linenos" data-linenos="2 "></span><span class="l l-Scalar l-Scalar-Plain">Filesystem blocks soft hard inodes soft hard</span>
<span class="linenos" data-linenos="3 "></span><span class="l l-Scalar l-Scalar-Plain">/dev/sdb1   0       0   0      0    0   0</span>
</code></pre></div>
<p>El significado de cada columna es:</p>
<ul>
<li><strong>Filesystem</strong>, indica el volumen en el que se activan las cuotas</li>
<li><strong>blocks</strong>, señala el número de bloques que el usuario o grupo está utilizando</li>
<li><strong>inodes</strong>, apunta el número de nodos-i que el usuario o grupo está usando</li>
<li><strong>soft</strong>, representa un valor de bloques o nodos-i que permite sobrepasar durante un determinado tiempo</li>
<li><strong>hard</strong>, es el límite de bloques o nodos-i que no es posible superar</li>
</ul>
<p>Modificando estos valores y guardando el fichero se establecerán las cuotas del usuario <strong>administrador</strong>. Además se debe tener en cuenta:</p>
<ul>
<li>Configurar un valor de cuota a cero significa que no existe límite alguno de almacenamiento para ese usuario.</li>
<li>Las cuotas para grupos se realizan exactamente igual que con los usuarios. Si es necesario su edición, se volverá a ejecutar el mismo comando y se modificarán los valores oportunos.</li>
</ul>
<p>En la descripción de la columna <strong>soft</strong> se hizo referencia a que ese valor es posible rebasarlo durante un tiempo determinado. A ese tiempo se le conoce como <strong>periodo de gracia</strong>, y una vez superado el límite flexible <strong>soft</strong> se convierte en límite rígido no pudiendo superarlo. </p>
<p>Para modificar esta configuración se utiliza el comando:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">sudo edquota -t</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<p>Establecerá un valor para el volumen que afectará a todos los usuarios y grupos que tengan una cuota configurada en dicho volumen.</p>
</div>
<p>Para consultar todas las cuotas disponibles se utilizará el comando:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">sudo repquota /dev/sdb1</span>
</code></pre></div>
<p>El cual ofrecerá información detallada sobre los usuarios y grupos que disponen de cuota en dicho volumen.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">\*\*\* Report for user quotas on device /dev/sdb1</span>
<span class="linenos" data-linenos="2 "></span><span class="l l-Scalar l-Scalar-Plain">Block grace time</span><span class="p p-Indicator">:</span> <span class="nt">7days; Inode grace time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">7days</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span>                            <span class="l l-Scalar l-Scalar-Plain">Block limits                File limits</span>
<span class="linenos" data-linenos="5 "></span><span class="l l-Scalar l-Scalar-Plain">User            used    soft    hard  grace    used  soft  hard  grace</span> 
<span class="linenos" data-linenos="6 "></span><span class="l l-Scalar l-Scalar-Plain">----------------------------------------------------------------------</span> 
<span class="linenos" data-linenos="7 "></span><span class="l l-Scalar l-Scalar-Plain">root      --      20       0       0              2     0     0</span>       
<span class="linenos" data-linenos="8 "></span><span class="l l-Scalar l-Scalar-Plain">usuario   +-     351     300       0             15     0     0</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title"><strong>A tener en cuenta</strong></p>
<p>El formato de salida del informe es autoexplicativo, a excepción de la segunda columna. Los guiones que aparecen a la derecha del nombre de usuario, representan si se ha excedido o no el límite flexible tanto de bloques como de nodos-i.</p>
</div>
<p>Si se excede este límite el <strong>-</strong>  será modificado por <strong>+</strong>. De esta forma es relativamente sencillo buscar aquellos usuarios que han superado el límite flexible a través del comando</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>    <span class="l l-Scalar l-Scalar-Plain">sudo repqutota /dev/sdb1 | grep “\+”</span>
</code></pre></div>
<p>Para calcular el tamaño de la cuota a través de bloques será necesario conocer el tamaño del bloque del volumen al que se han aplicado las cuotas. Para ello se puede usar el comando <strong>tune2fs</strong> que ofrece amplia información sobre las características de un volumen, entre toda ella, el número de bloques:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">tune2fs -l /dev/sdb1 | grep “Block size”</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title"><strong>A tener en cuenta</strong></p>
<p>Ahora tan solo queda multiplicar este tamaño por el número de bloques asignado a la cuota.</p>
</div>
<p>Por último, es posible desactivar las cuotas de forma temporal para, por ejemplo, realizar ciertas tareas de mantenimiento o administración,</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">quotaoff /dev/sdb1</span>
</code></pre></div>
<p>Y volverlas a activar</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">quotaon /dev/sdb1</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA</strong></p>
<ul>
<li>Recuerda que esta desactivación es temporal. Si se desactivan las cuotas con este comando y se reinicia el sistema, volverán a estar activas ya que se inicializan a través del fichero <strong>/etc/fstab</strong>. </li>
<li>Si es necesario desactivarlas de forma permanente se deben configurar con un valor de cero en el archivo de cuotas.</li>
</ul>
</div>
<h2 id="actividades-iniciales-ud7">Actividades Iniciales UD7<a class="headerlink" href="#actividades-iniciales-ud7" title="Permanent link">&para;</a></h2>
<ol start="701">
<li><a href="Practica14_samba.html">Instalación Servidor Samba</a></li>
</ol>
<h2 id="actividades-de-desarrollo-ud7_01">Actividades de desarrollo UD7_01<a class="headerlink" href="#actividades-de-desarrollo-ud7_01" title="Permanent link">&para;</a></h2>
<ol start="702">
<li><a href="Practica15_SambaSecUsers.html">Configuración de Secciones y Usuarios en SAMBA</a></li>
</ol>
<h2 id="actividades-de-desarrollo-ud7_02">Actividades de desarrollo UD7_02<a class="headerlink" href="#actividades-de-desarrollo-ud7_02" title="Permanent link">&para;</a></h2>
<ol start="703">
<li><a href="Practica16_SambaDC.html">Configuración de Controlador de Dominio en SAMBA</a></li>
</ol>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Pie">
      
        
        <a href="071_ServiciosRedRecursosCompartidos.html" class="md-footer__link md-footer__link--prev" aria-label="Anterior: 7.1- Servicios de red para compartir recursos" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              7.1- Servicios de red para compartir recursos
            </div>
          </div>
        </a>
      
      
        
        <a href="073_NFS.html" class="md-footer__link md-footer__link--next" aria-label="Siguiente: 7.3- NFS" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Siguiente
              </span>
              7.3- NFS
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            2021-2022 Fº Javier Hernández - Licencia CC BY-NC-SA
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="mailto:<fj.hernandez@edu.gva.es>" target="_blank" rel="noopener" title="" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM178.117 262.104C87.429 196.287 88.353 196.121 64 177.167V152c0-13.255 10.745-24 24-24h272c13.255 0 24 10.745 24 24v25.167c-24.371 18.969-23.434 19.124-114.117 84.938-10.5 7.655-31.392 26.12-45.883 25.894-14.503.218-35.367-18.227-45.883-25.895zM384 217.775V360c0 13.255-10.745 24-24 24H88c-13.255 0-24-10.745-24-24V217.775c13.958 10.794 33.329 25.236 95.303 70.214 14.162 10.341 37.975 32.145 64.694 32.01 26.887.134 51.037-22.041 64.72-32.025 61.958-44.965 81.325-59.406 95.283-70.199z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": ["header.autohide", "toc.integrate", "navigation.indexes"], "translations": {"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}, "search": "assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.756773cc.min.js"></script>
      
    
  </body>
</html>