
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://javierhernadez81.github.io/aso2122/022_LDAP.html">
      
      <link rel="icon" href="imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>2.2- LDAP - Administración de Sistemas Operativos</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      

  


  

  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0CPJP88MBF"),document.addEventListener("DOMContentLoaded",function(){"undefined"!=typeof location$&&location$.subscribe(function(t){gtag("config","G-0CPJP88MBF",{page_path:t.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-0CPJP88MBF"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="teal">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ldap" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="index.html" title="Administración de Sistemas Operativos" class="md-header__button md-logo" aria-label="Administración de Sistemas Operativos" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Administración de Sistemas Operativos
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2.2- LDAP
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="teal"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="teal"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Administración de Sistemas Operativos" class="md-nav__button md-logo" aria-label="Administración de Sistemas Operativos" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    Administración de Sistemas Operativos
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        1.- Tools: Scripting y Docker
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="1.- Tools: Scripting y Docker" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          1.- Tools: Scripting y Docker
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="011_ShellScripting.html" class="md-nav__link">
        1.1- ShellScripting
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="012_PowerShell.html" class="md-nav__link">
        1.2- PowerShell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="013_Docker.html" class="md-nav__link">
        1.3- Docker
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        2.- Administración de servicios de directorio
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="2.- Administración de servicios de directorio" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          2.- Administración de servicios de directorio
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="021_Introduccion_SD.html" class="md-nav__link">
        2.1- Introducción de servicios de directorio
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          2.2- LDAP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="022_LDAP.html" class="md-nav__link md-nav__link--active">
        2.2- LDAP
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#autenticar-usuarios" class="md-nav__link">
    AUTENTICAR USUARIOS
  </a>
  
    <nav class="md-nav" aria-label="AUTENTICAR USUARIOS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pam" class="md-nav__link">
    PAM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nss" class="md-nav__link">
    NSS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelo-de-informacion-de-ldap" class="md-nav__link">
    Modelo de Información de LDAP
  </a>
  
    <nav class="md-nav" aria-label="Modelo de Información de LDAP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#entrada" class="md-nav__link">
    Entrada
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clases-de-objetos-objectclasses" class="md-nav__link">
    Clases de objetos (objectClasses)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#atributos" class="md-nav__link">
    Atributos
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ldif" class="md-nav__link">
    LDIF
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esquema-ldap" class="md-nav__link">
    Esquema LDAP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#herramientas-de-gestion-de-usuarios" class="md-nav__link">
    Herramientas de gestión de usuarios.
  </a>
  
    <nav class="md-nav" aria-label="Herramientas de gestión de usuarios.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ldap-utils" class="md-nav__link">
    ldap-utils
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-de-openldap" class="md-nav__link">
    Configuración de OpenLDAP
  </a>
  
    <nav class="md-nav" aria-label="Configuración de OpenLDAP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#slapdconf" class="md-nav__link">
    slapd.conf
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades-iniciales" class="md-nav__link">
    Actividades Iniciales
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades-desarrollo-ud2_01" class="md-nav__link">
    Actividades Desarrollo UD2_01
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades-desarrollo-ud2_02" class="md-nav__link">
    Actividades Desarrollo UD2_02
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades-desarrollo-ud2_03" class="md-nav__link">
    Actividades Desarrollo UD2_03
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades-desarrollo-ud2_04" class="md-nav__link">
    Actividades Desarrollo UD2_04
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="023_ActiveDirectory.html" class="md-nav__link">
        2.3- Active Directory
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        3.- Administración de procesos del sistema
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="3.- Administración de procesos del sistema" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          3.- Administración de procesos del sistema
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="031_Planificador.html" class="md-nav__link">
        3.1- Planificación y sincronización de procesos
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="032_GestionProcesos.html" class="md-nav__link">
        3.2- Gestión de los procesos del sistema
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="033_ArranqueServicios.html" class="md-nav__link">
        3.3- Secuencia de arranque del sistema. Demonios y servicios
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        4.- Información del sistema
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="4.- Información del sistema" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          4.- Información del sistema
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="041_EstructuraDirectorios.html" class="md-nav__link">
        4.1- Estructura de directorios
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="042_ArchivosVirtualSWinstaladoRendimiento.html" class="md-nav__link">
        4.2- VFS, Sw Instalado y Gestión Rendimiento
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="043_Planificacio%CC%81nTareas.html" class="md-nav__link">
        4.3- Planificación de Tareas
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        5.- Servicios de acceso y administración remota
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="5.- Servicios de acceso y administración remota" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          5.- Servicios de acceso y administración remota
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="051_AccesoRemotoLinux.html" class="md-nav__link">
        5.1- Acceso Remoto en modo texto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="052_EscritorioRemoto.html" class="md-nav__link">
        5.2- Escritorio Remoto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="053_HerramientasGraficAdminRemota.html" class="md-nav__link">
        5.3- Herramientas gráficas externas.
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        6.- Administración de Servidores de Impresión
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="6.- Administración de Servidores de Impresión" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          6.- Administración de Servidores de Impresión
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="061_ServidoresImpresion.html" class="md-nav__link">
        6.1- Servidores de Impresión
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="062_ServidoresImpresionLinux.html" class="md-nav__link">
        6.2- Servidor de impresión en GNU/Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="063_ServidorImpresionWindowsServer.html" class="md-nav__link">
        6.3- Servidor de impresión en Windows Server
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        7.- Integración de sistemas operativos en red libres y propietarios
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="7.- Integración de sistemas operativos en red libres y propietarios" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          7.- Integración de sistemas operativos en red libres y propietarios
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="071_ServiciosRedRecursosCompartidos.html" class="md-nav__link">
        7.1- Servicios de red para compartir recursos
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="072_Samba.html" class="md-nav__link">
        7.2- Samba
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="073_NFS.html" class="md-nav__link">
        7.3- NFS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="074_NextCloud.html" class="md-nav__link">
        7.4- NextCloud
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="ldap">LDAP<a class="headerlink" href="#ldap" title="Permanent link">&para;</a></h1>
<p>El <strong>LDAP (Lightweight Directory Access Protocol)</strong> es un protocolo a nivel de aplicación que da acceso a un servicio de directorio ordenado y distribuido para la búsqueda de la información de un entrono de red.</p>
<ul>
<li>
<p>En la década de los 80, la especificación de directorio <strong>X.500</strong> vio la luz. El protocolo que daba acceso a la información contenida en él, fue DAP
(Directory Access Protocol) y estaba basado en la <strong>pila de protocolos OSI (Open Systems Interconexion)</strong>. Gracias al auge de Internet, la pila de protocolos TCP/IP cobraron especial protagonismo y su uso fue generalizado en cualquier infraestructura de red, incluidas las LAN.</p>
</li>
<li>
<p>Ante esta situación, en <strong>1993</strong> se implementó el protocolo <strong>LDAP</strong> que utilizaba la pila de protocolos TCP/IP para el acceso a la información contenido en un servicio de directorio. El funcionamiento de LDAP es <strong>relativamente simple</strong>: un cliente se inicia una sesión en un servidor LDAP solicitando alguna información.</p>
</li>
</ul>
<figure>
  <img src="imagenes/02/LDAP.png" width="700"/>
  <figcaption>Esquema de funcionamiento del protocolo LDAP</figcaption>
</figure>

<div class="admonition conclusión">
<p class="admonition-title">Conclusión</p>
<ul>
<li><strong>LDAP, es un protocolo que ofrece el acceso a un servicio de directorio</strong> implementado sobre un entorno de red, con el objeto de acceder a una determinada información. Puede ejecutarse sobre TCP/IP o sobre cualquier otro servicio de transferencia orientado a la conexión.</li>
<li>Podemos considerarlo como un <strong>sistema de almacenamiento de red al que se pueden realizar consultas.</strong></li>
</ul>
</div>
<ul>
<li>Antes de trabajar con LDAP, hay varios conceptos importantes que deben entenderse. El primer paso importante para dar el acceso comentado se basa en la <strong>autentificación de usuarios</strong>.</li>
</ul>
<h2 id="autenticar-usuarios">AUTENTICAR USUARIOS<a class="headerlink" href="#autenticar-usuarios" title="Permanent link">&para;</a></h2>
<p>Existen diferentes formas de autenticar usuarios en una red linux, pero una de las más usadas es la combinación de tres herramientas diferentes: <strong>NSS</strong>, <strong>PAM</strong> y <strong>LDAP</strong>.</p>
<ul>
<li>La idea consiste en disponer de un servidor que facilite la acción de <strong>autenticar usuarios</strong>, de modo, que éstos recurran al servidor cada vez que un cliente necesite identificarse. De esta forma, <strong>la cuenta de usuario no es específica de un equipo cliente</strong>, si no que será válida en cualquier equipo de la red que haya sido debidamente configurado.</li>
</ul>
<figure>
  <img src="imagenes/02/AutenticarLDAP.png" width="550"/>
  <figcaption>Herramientas autenticación usuarios en Unix</figcaption>
</figure>

<h3 id="pam">PAM<a class="headerlink" href="#pam" title="Permanent link">&para;</a></h3>
<p><strong>Pluggable Authentication Module (PAM)</strong>: o módulo de autenticación conectable en español, es un mecanismo para integrar múltiples esquemas de autenticación de bajo nivel en una interfaz de programación de aplicaciones (API) de alto nivel.</p>
<ul>
<li>
<p>Es decir, Establece una <strong>interfaz entre los programas de usuario y distintos métodos de autenticación</strong>. De esta forma, el método de autenticación, se hace <strong>transparente para los programas</strong>.</p>
</li>
<li>
<p>La idea se basa en la creación de <strong>módulos de autenticación</strong>. Esto hace que, <strong>sin realizar modificaciones en el sistema</strong>, podamos utilizar métodos que vayan desde el <strong>uso típico</strong> de un nombre de usuario y una contraseña, hasta aceptar <strong>contraseñas de un solo uso</strong>, <strong>restringir el acceso</strong> a determinados horarios o establecer políticas de autenticación específicas para cada usuario o grupos de usuarios.</p>
</li>
</ul>
<figure>
  <img src="imagenes/02/estructuraPAM.png" width="700"/>
  <figcaption>Esquema de la estructura PAM</figcaption>
</figure>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>En la actualidad, <strong>PAM es el método que utilizan la mayoría de las aplicaciones</strong> y herramientas de UNIX para autenticar usuarios.</p>
</div>
<h3 id="nss">NSS<a class="headerlink" href="#nss" title="Permanent link">&para;</a></h3>
<p><strong>Name Service Switch</strong> es un servicio que <strong>permite la resolución de nombres de usuario y contraseñas</strong> (o grupos) mediante el acceso a diferentes orígenes de información.</p>
<ul>
<li>En condiciones normales, esta información se encuentra en los archivos locales del sistema operativo, en concreto en <ul>
<li><em>/etc/passwd</em>, <em>/etc/shadow</em> y <em>/etc/group</em></li>
</ul>
</li>
<li>pero puede proceder de otras fuentes, como <strong>DNS (Domain Name System)</strong>, <strong>NIS (Network Information Service)</strong>, <strong>LDAP (Lightweight Directory Access Protocol)</strong> o <strong>WINS (Windows Internet Name Service)</strong>.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Este servicio esta gestionado desde el fichero: <strong>/etc/nsswitch.conf</strong></p>
</div>
<h2 id="modelo-de-informacion-de-ldap">Modelo de Información de LDAP<a class="headerlink" href="#modelo-de-informacion-de-ldap" title="Permanent link">&para;</a></h2>
<p>La estructura básica de LDAP es un árbol de nodos llamado <strong>Directory Information Tree (DIT)</strong> donde cada <strong>objeto o nodo</strong> es una entrada. La parte superior del árbol se llama comúnmente <strong>raíz</strong> (también conocida como <strong>base</strong> o <strong>sufijo</strong> ).</p>
<p>Cada entrada se define por un <strong>DN (Distinguished Name)</strong> y contiene un conjunto de atributos. Este DN es una cadena que indica la ruta en el árbol de dicha entrada y será único en todo el árbol. Un ejemplo del aspecto que ofrece un DN sería el siguiente:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li><strong>cn=usuario1,ou=usuarios,dc=midominio,dc=es</strong></li>
<li>Puede verse que cada componente (la coma es el carácter separador) se muestra como un par <strong>«atributo=valor»</strong> donde el atributo es una abreviatura usada por LDAP.</li>
</ul>
</div>
<p>Cada <strong>entrada</strong> en el árbol tiene una <em>entrada principal</em> (objeto) y cero o más <em>entradas secundarias</em> (objetos). Cada entrada secundaria (objeto) es un hermano de las otras entradas secundarias de su padre.</p>
<p>Cada entrada se compone de (es una instancia de) una o más <strong>clases de objeto</strong> (<strong>objectClasses</strong>). Las <strong>objectClasses</strong> contienen cero o más atributos. Los atributos tienen nombres (y a veces abreviaturas o <strong>alias</strong>) y normalmente contienen datos. </p>
<ul>
<li>A continuación se muestra un diagrama para entender mejor estos conceptos:</li>
</ul>
<figure>
  <img src="imagenes/02/ModeloLDAP.png" width="700"/>
  <figcaption>Modelo de información (datos) LDAP DIT</figcaption>
</figure>

<p><strong>Resumen:</strong></p>
<ol>
<li>Cada <strong>entrada</strong> (1) se compone de una o más <strong>clases de objetos</strong> (2)</li>
<li>Cada <strong>objectClass</strong> (2) tiene un nombre y es un contenedor de atributos (su definición identifica los atributos que puede o debe contener)</li>
<li>Cada <strong>atributo</strong> (3) tiene un nombre, contiene datos y es miembro de una o más <strong>clases de objetos</strong> (2)</li>
<li>Cuando se completa el DIT, cada <strong>entrada</strong> se identificará de forma única (en relación con su entrada principal) en la jerarquía por los datos que contiene (en sus atributos que están contenidos en su (s) objectClasses (s)).</li>
</ol>
<h3 id="entrada">Entrada<a class="headerlink" href="#entrada" title="Permanent link">&para;</a></h3>
<p>Una <strong>entrada LDAP</strong> es una recopilación de información sobre una entidad. Cada entrada consta de tres componentes principales:</p>
<ul>
<li>Nombre distinguido DN y RDN (Relative Distinguished Name)</li>
<li>Colección de clases de objetos (objectClasses)</li>
<li>Atributos</li>
</ul>
<p>Cada uno de estos se describe con más detalle a continuación.</p>
<h4 id="dn-y-rdn">DN y RDN<a class="headerlink" href="#dn-y-rdn" title="Permanent link">&para;</a></h4>
<p><strong>El nombre distinguido de una entrada, a menudo denominado DN</strong>, identifica de forma única esa entrada y su posición en la jerarquía del árbol de información de directorio (DIT). <strong>El DN de una entrada LDAP es muy parecido a la ruta a un archivo en un sistema de archivos</strong>.</p>
<ul>
<li>Un <strong>DN LDAP se compone de cero o más elementos</strong> denominados nombres distinguidos relativos o <strong>RDN</strong>. Cada RDN se compone de uno o más (generalmente solo uno) pares de atributo-valor. </li>
</ul>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li><strong>"uid = john.doe"</strong> representa un RDN compuesto por un atributo llamado "uid" con un valor de "john.doe".</li>
<li>Si un RDN tiene varios pares de atributo-valor, están separados por signos más, como <strong>"givenName = John + sn = Doe"</strong>.</li>
</ul>
</div>
<h5 id="dse">DSE<a class="headerlink" href="#dse" title="Permanent link">&para;</a></h5>
<p><strong>El nombre distinguido especial compuesto por cero RDN</strong> (y por lo tanto tiene una representación de cadena que es solo una <strong>cadena vacía</strong>) a veces se denomina <strong>"DN nulo"</strong> y hace referencia a un tipo especial de entrada llamado <strong>DSE raíz</strong> que proporciona información sobre el contenido y las capacidades de el servidor de directorio.</p>
<h5 id="multiples-rdn">Múltiples RDN<a class="headerlink" href="#multiples-rdn" title="Permanent link">&para;</a></h5>
<p>Para DN con <strong>múltiples RDN</strong>, el orden de los RDN especifica la posición de la entrada asociada en el DIT. Los RDN están separados por comas, y cada RDN en un DN representa un nivel en la jerarquía en orden descendente (es decir, acercándose a la raíz del árbol, que se denomina contexto de nomenclatura).</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>el DN <strong>"uid = john.doe, ou = People, dc = example, dc = com"</strong> tiene cuatro RDN.</p>
</div>
<h3 id="clases-de-objetos-objectclasses">Clases de objetos (objectClasses)<a class="headerlink" href="#clases-de-objetos-objectclasses" title="Permanent link">&para;</a></h3>
<ul>
<li>Las clases de objeto son <strong>elementos de esquema que especifican colecciones de tipos de atributos</strong> que pueden estar relacionados con un tipo particular de objeto, proceso u otra entidad.</li>
<li>Las <strong>clases de objetos</strong> son, esencialmente, <strong>contenedores de atributos</strong> y se describen utilizando definiciones <strong>ASN.1</strong> .</li>
<li>Cada <strong>objectClass tiene un nombre único</strong>.</li>
<li>Existe un número confuso de <strong>clases de objetos</strong> <strong>PREDEFINIDAS</strong>, cada una de las cuales contiene un montón de <strong>atributos</strong> adecuados para casi todas las implementaciones LDAP comunes.</li>
</ul>
<p>Las clases de objetos tienen tres características principales:</p>
<ol>
<li>La <strong>clase de objeto</strong> define si un miembro de atributo <strong>MUST</strong> ( obligatorio ) estar presente o <strong>MAY</strong> ( opcional ) estar presente.</li>
<li>Cada <strong>clase de objeto</strong> tiene un tipo que pueden ser <em>estructurales</em>, <em>auxiliar</em> o <em>RESUMEN</em>. En esta etapa es suficiente saber que debe haber una, y solo una, <strong>clase de objeto</strong> <em>ESTRUCTURAL </em>en una entrada y que puede haber cero o más clases de objeto <em>AUXILIAR</em>.</li>
<li>Una <strong>clase de objeto</strong> puede ser parte de una jerarquía, en cuyo caso <strong>hereda</strong> todas las características de su (s) clase (s) de objeto principal (incluidos todos los atributos que contiene).</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>objectClasses</strong> son contenedores y controlan qué atributos se pueden agregar a cada entrada, pero por lo demás tienden a permanecer en segundo plano en lo que respecta al acceso e interrogación (búsqueda) del DIT. <strong>Los atributos y las entradas son los elementos realmente visibles</strong>.</p>
</div>
<h3 id="atributos">Atributos<a class="headerlink" href="#atributos" title="Permanent link">&para;</a></h3>
<p>Cada <strong>atributo</strong> de una entrada tendrá un <strong>tipo</strong> y un <strong>valor</strong> con el formato atributo/valor que permite caracterizar un aspecto del objeto que define la entrada. Estos atributos tienen nombres que hacen referencia a su contenido y pueden ser de dos tipos:</p>
<ol>
<li><strong>Atributos normales</strong> : Son los atributos que identifican al objeto</li>
<li><strong>Atributos operativos</strong> : Son los atributos que utiliza el servidor para administrar el directorio</li>
</ol>
<p>Entre los atributos que suelen utilizarse habitualmente, encontramos los siguientes, aunque puede haber muchos mas:</p>
<ul>
<li><strong>dn</strong> (distinguished name): nombre distintivo de una entrada, contiene un conjunto de atributos y es de carácter único.</li>
<li><strong>dc</strong> (domain component): se refiere al componente del dominio, ya sea un componente, una etiqueta o un nombre de dominio DNS.</li>
<li><strong>ou</strong> (organizational unit): unidad organizativa.</li>
<li><strong>cn</strong> (common name): nombre común.</li>
<li><strong>sn</strong> (surname): apellido.</li>
<li><strong>uid</strong> (userid): nombre de usuario.</li>
<li><strong>mail:</strong> dirección de e-mail.</li>
<li><strong>telephoneNumber:</strong> número de teléfono.</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li><strong>DN</strong> cn=John Smith, o=airius.com, c=DE </li>
<li><strong>RDN</strong> cn=John Smith + DN of ancestor o=airius.com, c=DE</li>
</ul>
</div>
<figure>
  <img src="imagenes/02/NomenclaturaLDAP.png" width="700"/>
  <figcaption>Modelo de nomenclatura LDAP</figcaption>
</figure>

<h4 id="caracteristicas-de-atributos">Características de Atributos<a class="headerlink" href="#caracteristicas-de-atributos" title="Permanent link">&para;</a></h4>
<p>Cada <strong>atributo</strong> tiene un nombre único (<strong>y una forma abreviada o alias</strong>) y normalmente contiene datos. Los atributos siempre están asociados con (son miembros de) una o más <strong>ObjectClasses</strong> . Los atributos tienen una serie de características interesantes:</p>
<ol>
<li>Todos los <strong>atributos</strong> son miembros de una o más <strong>clases de objeto</strong>.</li>
<li>Cada <strong>atributo</strong> define el tipo de datos (la palabra clave es SINTAXIS) que puede contener. Los tipos de datos pueden ser: <em>Strings</em>, <em>Numbers (Integer)</em>, <em>Time</em>, <em>Telephone Numbers</em>, <em>Boolean</em>, <em>Binary</em>, <em>Distinguished Name</em>, <em>Bit Strings</em>, <em>LDAP Supported Syntaxes</em>.</li>
<li>Los atributos pueden formar parte de una <em>jerarquía</em>, en cuyo caso el atributo <em>hijo hereda todas las características del atributo padre</em>. En el caso de los atributos, se usa una jerarquía para simplificar y acortar las definiciones de atributos (en ASN.1) donde muchos atributos comparten propiedades comunes como la longitud máxima o si son o no sensibles a mayúsculas y minúsculas, etc. ningún otro significado.</li>
<li>Los atributos pueden ser opcionales (la palabra clave es <strong>MAY</strong>) u obligatorios (la palabra clave es <strong>MUST</strong>) como se describe en las definiciones <em>ASN.1</em> para la clase de objeto de la que son miembros. Un atributo puede ser opcional en una clase de objeto y obligatorio en otra. Es la clase de objeto la que determina esta propiedad.</li>
<li>Los <strong>atributos</strong> aparentemente son <strong>aleatorios</strong> que se recogen de todas partes de la documentación; es confuso al principio, pero proviene de la característica opcional de la mayoría de los atributos. Permite un enfoque de '<em>pick-n-mix</em>' para poblar una entrada. Se puede buscar el atributo que se desee, y buscar la clase de objeto de la que es miembro (puede haber más de uno) y confirmar que todos los demás atributos que no se desean utilizar en la clase de objeto sean opcionales. Se puede revisar en <a href="http://zytrax.com/books/ldap/ape/index.html#attributes">Atributos comunmente utilizados</a>.</li>
<li>Los atributos pueden tener un valor <em>ÚNICO</em> o <em>MÚLTIPLE</em> (como se describe en sus definiciones ASN.1 ). <ol>
<li><strong>VALOR ÚNICO</strong> significa que solo un valor de datos puede estar presente para el atributo . </li>
<li><strong>MULTIVALOR</strong> significa que el atributo puede aparecer varias veces en una clase de <strong>entrada / objeto</strong> con diferentes valores de datos. 
Si el atributo describe, por ejemplo, una dirección de correo electrónico, puede haber una, dos o 500 definiciones del atributo, cada una con una dirección de correo diferente (es múltipl ); este es uno de los varios métodos para tratar los alias de correo electrónico en los diseños de directorios. En este caso el valor predeterminado de un atributo es MULTIVALOR (permitir múltiples valores).</li>
</ol>
</li>
<li>Los atributos tienen nombres y, a veces, un alias (como se describe en sus definiciones ASN.1), por ejemplo, el atributo con un nombre de cn es un miembro del objectClass llamado person (y muchos otros) y tiene un alias de commonName . Se puede utilizar commonName o cn para hacer referencia a este atributo .</li>
<li>En cada nivel de la jerarquía, <strong>los datos contenidos en un atributo se pueden utilizar para identificar de forma única la entrada</strong>. Puede ser cualquier atributo de la entrada. Incluso puede ser una combinación de dos o más atributos.</li>
<li>Los valores de atributo seleccionados para contener los datos únicos a veces se denominan atributos de nomenclatura o el nombre distinguido relativo (RDN), ya comentados.</li>
</ol>
<h2 id="ldif">LDIF<a class="headerlink" href="#ldif" title="Permanent link">&para;</a></h2>
<p>La adición de entradas se puede realizar de diversas formas, una de las cuales es mediante el uso de <strong>archivos de intercambio de datos LDAP (LDIF)</strong>.</p>
<ul>
<li>Los <strong>LDIF</strong> son archivos de texto que describen la jerarquía del árbol, el árbol de <strong>información del directorio (DIT)</strong>, y los datos que se agregarán a cada atributo. </li>
<li>El siguiente es un ejemplo simple de un archivo LDIF que configura un DN raíz (dc = ejemplo, dc = com) y agrega tres entradas secundarias debajo de una entrada de <strong>personas</strong>.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="nt">version</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="c1">## version not strictly necessary (and some implementations reject it) but generally good practice</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="c1">## DEFINE DIT ROOT/BASE/SUFFIX ####</span>
<span class="linenos" data-linenos=" 6 "></span><span class="c1">## uses RFC 2377 (domain name) format</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="c1">## dcObject is an AUXILIARY objectclass and MUST</span>
<span class="linenos" data-linenos=" 9 "></span><span class="c1">## have a STRUCTURAL objectclass (organization in this case)</span>
<span class="linenos" data-linenos="10 "></span><span class="c1"># this is an ENTRY sequence and is preceded by a BLANK line</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="nt">dn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dc=example,dc=com</span>
<span class="linenos" data-linenos="13 "></span><span class="nt">dc</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example</span>
<span class="linenos" data-linenos="14 "></span><span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The best company in the whole world</span>
<span class="linenos" data-linenos="15 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dcObject</span>
<span class="linenos" data-linenos="16 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">organization</span>
<span class="linenos" data-linenos="17 "></span><span class="nt">o</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Example, Inc.</span>
<span class="linenos" data-linenos="18 "></span>
<span class="linenos" data-linenos="19 "></span><span class="c1">## FIRST Level hierarchy - people </span>
<span class="linenos" data-linenos="20 "></span><span class="c1"># this is an ENTRY sequence and is preceded by a BLANK line</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span><span class="nt">dn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ou=people, dc=example,dc=com</span>
<span class="linenos" data-linenos="23 "></span><span class="nt">ou</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">people</span>
<span class="linenos" data-linenos="24 "></span><span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">All people in organisation</span>
<span class="linenos" data-linenos="25 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">organizationalUnit</span>
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span><span class="c1">## SECOND Level hierarchy - people entries </span>
<span class="linenos" data-linenos="28 "></span><span class="c1"># this is an ENTRY sequence and is preceded by a BLANK line</span>
<span class="linenos" data-linenos="29 "></span>
<span class="linenos" data-linenos="30 "></span><span class="nt">dn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cn=Robert Smith,ou=people,dc=example,dc=com</span>
<span class="linenos" data-linenos="31 "></span><span class="nt">objectclass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inetOrgPerson</span>
<span class="linenos" data-linenos="32 "></span><span class="nt">cn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Robert Smith</span>
<span class="linenos" data-linenos="33 "></span><span class="nt">cn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Robert</span>
<span class="linenos" data-linenos="34 "></span><span class="nt">sn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Smith</span>
<span class="linenos" data-linenos="35 "></span><span class="nt">uid</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rsmith</span>
<span class="linenos" data-linenos="36 "></span><span class="nt">mail</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">robert@example.com</span>
<span class="linenos" data-linenos="37 "></span><span class="nt">mail</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">r.smith@example.com</span>
<span class="linenos" data-linenos="38 "></span><span class="nt">ou</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sales</span>
<span class="linenos" data-linenos="39 "></span>
<span class="linenos" data-linenos="40 "></span><span class="c1">## SECOND Level hierarchy - people entries </span>
<span class="linenos" data-linenos="41 "></span><span class="c1"># this is an ENTRY sequence and is preceded by a BLANK line</span>
<span class="linenos" data-linenos="42 "></span>
<span class="linenos" data-linenos="43 "></span><span class="nt">dn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cn=Bill Smith,ou=people,dc=example,dc=com</span>
<span class="linenos" data-linenos="44 "></span><span class="nt">objectclass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inetOrgPerson</span>
<span class="linenos" data-linenos="45 "></span><span class="nt">cn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Bill Smith</span>
<span class="linenos" data-linenos="46 "></span><span class="nt">cn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">William</span>
<span class="linenos" data-linenos="47 "></span><span class="nt">sn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Smith</span>
<span class="linenos" data-linenos="48 "></span><span class="nt">uid</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bsmith</span>
<span class="linenos" data-linenos="49 "></span><span class="nt">mail</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bill@example.com</span>
<span class="linenos" data-linenos="50 "></span><span class="nt">mail</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">b.smith@example.com</span>
<span class="linenos" data-linenos="51 "></span><span class="nt">ou</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">support</span>
<span class="linenos" data-linenos="52 "></span>
<span class="linenos" data-linenos="53 "></span><span class="c1">## SECOND Level hierarchy - people entries </span>
<span class="linenos" data-linenos="54 "></span><span class="c1"># this is an ENTRY sequence and is preceded by a BLANK line</span>
<span class="linenos" data-linenos="55 "></span>
<span class="linenos" data-linenos="56 "></span><span class="nt">dn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cn=John Smith,ou=people,dc=example,dc=com</span>
<span class="linenos" data-linenos="57 "></span><span class="nt">objectclass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inetOrgPerson</span>
<span class="linenos" data-linenos="58 "></span><span class="nt">cn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">John Smith</span>
<span class="linenos" data-linenos="59 "></span><span class="nt">sn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">smith</span>
<span class="linenos" data-linenos="60 "></span><span class="nt">uid</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jsmith</span>
<span class="linenos" data-linenos="61 "></span><span class="nt">mail</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jim@example.com</span>
<span class="linenos" data-linenos="62 "></span><span class="nt">mail</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">j.smith@example.com</span>
<span class="linenos" data-linenos="63 "></span><span class="nt">ou</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">accounting</span>
</code></pre></div>
<h2 id="esquema-ldap">Esquema LDAP<a class="headerlink" href="#esquema-ldap" title="Permanent link">&para;</a></h2>
<p>El <strong>esquema</strong> es una parte importante de LDAP. Similar a la definición del esquema de la base de datos, el esquema LDAP define la estructura y las reglas que debe seguir un directorio LDAP, como qué atributos tendrá una clase de objeto, qué estructura tienen estos atributos, etc. </p>
<ul>
<li>El <strong>servidor LDAP</strong> proporciona una manera de <strong>identificar categorías, atributos</strong> y otra información en el directorio LDAP, para que el servidor LDAP pueda reconocerlos. <strong>Para realizarlo se utlizan esquemas</strong>, que no es más que una <strong>unidad de empaquetado conveniente para contener clases de objetos y atributos muy similares</strong>.</li>
<li><strong>La principal diferencia</strong> con las bases de datos relacionales del protocolo LDAP es que estas ya estan predefinidas en los esquemas. por lo que nos ahorramos en insertar y definir las tablas de información.</li>
<li>En <strong>OpenLDAP</strong> los esquemas instalados se encuentran en cn = schema, cn = config y se pueden instalar esquemas adicionales usando este procedimiento.</li>
</ul>
<p>El siguiente diagrama ilustra el uso de esquemas como unidades de empaquetado:</p>
<figure>
  <img src="imagenes/02/EsquemaLdap.png" width="700"/>
  <figcaption>Ejemplo de la definición de Esquemas en LDAP</figcaption>
</figure>

<p>A nivel de comandos se pueden ver los esquemas predefinidos con:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">cd /etc/ldap/slapd.d/cn\=config/</span>
</code></pre></div>
<p>En el directorio <code>cn\=schema</code> se pueden ver los esquemas y ademas se pueden añadir más, pero no suele ser frecuente.</p>
<p>Para buscar los esquemas se puede utilizar:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">grep olcObjectClasses cn\=\{3\}inetorgperson.ldif|awk &#39;{print $5}&#39;</span>
<span class="linenos" data-linenos="2 "></span><span class="l l-Scalar l-Scalar-Plain">grep olcObjectClasses cn\=\{2\}inetorgperson.ldif|awk &#39;{print $5}&#39;</span>
<span class="linenos" data-linenos="3 "></span><span class="l l-Scalar l-Scalar-Plain">grep olcObjectClasses cn\=\{2\}nis.ldif|awk &#39;{print $5}&#39;</span>
<span class="linenos" data-linenos="4 "></span><span class="l l-Scalar l-Scalar-Plain">grep olcObjectClasses cn\=\{1\}cosine.ldif|awk &#39;{print $5}&#39;</span>
<span class="linenos" data-linenos="5 "></span><span class="l l-Scalar l-Scalar-Plain">grep olcObjectClasses cn\=\{0\}core.ldif|awk &#39;{print $5}&#39;</span>
</code></pre></div></p>
<h2 id="herramientas-de-gestion-de-usuarios">Herramientas de gestión de usuarios.<a class="headerlink" href="#herramientas-de-gestion-de-usuarios" title="Permanent link">&para;</a></h2>
<p>Una vez configurado el servidor LDAP, para la utilización normal debemos aprender cómo se anñaden nuevos usuarios o se modifican los atributos de los existentes.</p>
<ul>
<li>
<p>Para los objetos iniciales del directorio, primero se debe escribir un fichero en formato <strong>LDIF</strong> que incluya todos los atributos de la entrada y añaadirla al directorio con slapadd. En la <a href="#Actividades Desarrollo UD2_01">Actividades Desarrollo UD2_01</a>, se realizará un ejemplo guiado al respecto.</p>
</li>
<li>
<p>Este método es totalmente inadecuado para la utilización cuando el directorio está activo. Existen varias formas de actualizar las entradas del directorio o añadir nuevas, y en primer lugar veremos la utilización de las herramientas incluidas en el paquete <strong>ldap-utils</strong>.</p>
</li>
</ul>
<h3 id="ldap-utils">ldap-utils<a class="headerlink" href="#ldap-utils" title="Permanent link">&para;</a></h3>
<p>Para realizar modificaciones de los objetos del directorio directamente desde la línea de comandos, se pueden utilizar las herramientas del paquete <code>ldap-utils</code>, a continuación se describen algunas de ellas.</p>
<h4 id="mostrar-entradas">Mostrar entradas<a class="headerlink" href="#mostrar-entradas" title="Permanent link">&para;</a></h4>
<ul>
<li><code>ldapsearch</code> - buscar y mostrar entradas</li>
</ul>
<p>La herramienta <code>ldapsearch</code> resulta muy conveniente al momento de hacer consultas sobre los datos dentro de un directorio LDAP desde línea de comandos. </p>
<ul>
<li>A continuación se presentan una serie de consultas de ejemplo que pueden resultar muy útiles para obtener información valiosa de un árbol LDAP.</li>
</ul>
<h4 id="obtener-todos-los-objetos-de-un-directorio">Obtener todos los objetos de un directorio<a class="headerlink" href="#obtener-todos-los-objetos-de-un-directorio" title="Permanent link">&para;</a></h4>
<p>Para obtener todos los objetos en un directorio (dn) a partir de cierta base con el ejemplo de la práctica (<code>dc=pandora,dc=ldap</code>) y sin límite de para la respuesta, utilizar una consulta como la siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">ldapsearch -z 0 -H ldap://localhost:389 -W -D &quot;cn=admin,dc=pandora,dc=ldap&quot; -b &quot;dc=pandora,dc=ldap&quot; &quot;(objectclass=*)&quot;</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><code>-z 0</code>: evita cortar la respuesta una vez alcanzado cierto límite (cantidad de entradas).</li>
<li><code>-H ldap://localhost:389</code>: indica que consulte al servidor LDAP en el puerto 389 del host local.</li>
<li><code>-W</code>: indica que solicite la contraseña para el método de autenticación simple de manera interactiva.</li>
<li><code>-D "cn=admin,dc=pandora,dc=ldap"</code>: especifica el usuario con el cual se autentica en el servidor LDAP.</li>
<li><code>-b "dc=pandora,dc=ldap"</code>: especifica la base desde donde comenzar la búsqueda (en este caso se trata de la raíz del directorio).</li>
<li><code>"(objectclass=*)"</code>: especifica el filtro para la búsqueda (en este ejemplo todos los objetos, este a su vez es el filtro por defecto).</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>El punto importante es no olvidar especificar la base (<code>-b</code>). De lo contrario probablemente no haya resultados en la búsqueda:</p>
</div>
<ul>
<li>A este ejemplo se le puede añadir <code>grep</code> para filtrar sólo los dn:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">ldapsearch -z 0 -H ldap://localhost:389 -W -D &quot;cn=admin,dc=pandora,dc=ldap&quot; -b &quot;dc=pandora,dc=ldap&quot; &quot;(objectclass=*)&quot; | grep &quot;dn:&quot;</span>
</code></pre></div>
<ul>
<li>El resultado sería parecido a:</li>
</ul>
<p><img alt="" src="imagenes/02/BusqObjtLDAP.png" /></p>
<h4 id="obtener-todas-las-unidades-organizacionales">Obtener todas las unidades organizacionales<a class="headerlink" href="#obtener-todas-las-unidades-organizacionales" title="Permanent link">&para;</a></h4>
<p>Las <a href="https://technet.microsoft.com/en-us/library/cc978003.aspx">ou</a> (<em>Organizational Unit</em>) definen la jerarquía dentro de un dominio. Generalmente se utilizan para definir los departamentos o áreas dentro de una organización (empresa, red, sociedad, etc.).</p>
<p>Para obtener una lista de todas las ou presentes en un directorio, se puede utilizar el filtro <code>"(ou=*)"</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">ldapsearch -z 0 -H ldap://localhost:389 -W -D &quot;cn=admin,dc=pandora,dc=ldap&quot; -b &quot;dc=pandora,dc=ldap&quot; &quot;(ou=*)&quot; | grep &quot;dn:&quot;</span>
</code></pre></div>
<ul>
<li>Resultado</li>
</ul>
<p><img alt="" src="imagenes/02/BusqOuLDAP.png" /></p>
<h4 id="listar-todos-los-usuarios">Listar todos los usuarios<a class="headerlink" href="#listar-todos-los-usuarios" title="Permanent link">&para;</a></h4>
<p>Esta consulta depende de la jerarquía y la clase utilizada para almacenar usuarios dentro de un árbol LDAP. Sin embargo, generalmente se utiliza la clase <a href="https://tools.ietf.org/html/rfc2798">inetOrgPerson</a> para almacenar usuarios dentro de un directorio LDAP, la cual posee el atributo <code>uid</code>.</p>
<p>De esta forma, para listar todos los usuarios presentes en un directorio, simplemente recurrir al filtro <code>"(uid=*)"</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">ldapsearch -z 0 -H ldap://localhost:389 -W -D &quot;cn=admin,dc=pandora,dc=ldap&quot; -b &quot;dc=pandora,dc=ldap&quot; &quot;(uid=*)&quot; | grep &quot;dn:&quot;</span>
</code></pre></div>
<ul>
<li>Resultado</li>
</ul>
<p><img alt="" src="imagenes/02/BusqUsuerLDAP.png" /></p>
<h4 id="determinar-todas-las-clases-en-uso">Determinar todas las clases en uso<a class="headerlink" href="#determinar-todas-las-clases-en-uso" title="Permanent link">&para;</a></h4>
<p>Las clases de un directorio LDAP determinan el formato con el que se representan los datos de los objetos almacenados en el árbol. Cada objeto (entrada en un directorio LDAP) pertenece a al menos una clase. Sin embargo es común que cada objeto pertenezca a varias clases. Básicamente las clases definen qué atributos y de qué formato puede poseer un objeto.</p>
<p>Para listar todas las clases actualmente en uso por todos los objetos, es necesario volcar todo el contenido del árbol y filtrar con <code>grep</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">ldapsearch -z 0 -H ldap://localhost:389 -W -D &quot;cn=admin,dc=pandora,dc=ldap&quot; -b &quot;dc=pandora,dc=ldap&quot; &quot;(objectclass=*)&quot; | grep objectClass | sort | uniq</span>
</code></pre></div>
<ul>
<li>Resultado</li>
</ul>
<p><img alt="" src="imagenes/02/BusqClassLDAP.png" /></p>
<h4 id="manipular-entradas">Manipular entradas<a class="headerlink" href="#manipular-entradas" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><code>ldapmodify</code> - modificar una entrada</p>
</li>
<li>
<p><code>ldapadd</code> - agregar una nueva entrada</p>
</li>
<li>
<p><code>ldapdelete</code> - eliminar y entrar</p>
</li>
<li>
<p><code>ldapmodrdn</code> - cambiar el nombre de una entrada</p>
</li>
<li>
<p><code>ldappasswd</code> : cambie la contraseña de una entrada</p>
</li>
</ul>
<h6 id="ejemplos">Ejemplos:<a class="headerlink" href="#ejemplos" title="Permanent link">&para;</a></h6>
<ol>
<li>
<p>Añadir y eliminar nuevos grupos con <code>ldapadd</code> &amp; <code>ldapdelete</code></p>
<ol>
<li>Se crea un archivo .ldif para añadir un nuevo grupo y se añade con <code>ldapadd</code>:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">nano aso.ldif</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">dn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ou=aso,dc=pandora,dc=ldap</span>
<span class="linenos" data-linenos="2 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">organizationalUnit</span>
<span class="linenos" data-linenos="3 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">top</span>
<span class="linenos" data-linenos="4 "></span><span class="nt">ou</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">aso</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">ldapadd -x -W -D &quot;cn=admin,dc=pandora,dc=ldap&quot; -f aso.ldif</span>
</code></pre></div>
<ol start="2">
<li>Para borrarlo se utilizaría: </li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">ldapdelete -W -D &quot;cn=admin,dc=pandora,dc=ldap&quot; &quot;ou=aso,dc=pandora,dc=ldap&quot;</span>
</code></pre></div>
</li>
<li>
<p>Añadir y eliminar usuarios con <code>ldapadd</code> &amp; <code>ldapdelete</code></p>
<ol>
<li>Se crea un archivo .ldif para añadir un nuevo grupo y se añade con <code>ldapadd</code>:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">nano javier.ldif</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="nt">dn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">uid=javier,ou=usuarios,dc=pandora,dc=ldap</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inetOrgPerson</span>
<span class="linenos" data-linenos=" 3 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">posixAccount</span>
<span class="linenos" data-linenos=" 4 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">shadowAccount</span>
<span class="linenos" data-linenos=" 5 "></span><span class="nt">cn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Javier</span>
<span class="linenos" data-linenos=" 6 "></span><span class="nt">sn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Hernandez</span>
<span class="linenos" data-linenos=" 7 "></span><span class="nt">userPassword</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">SSHA</span><span class="p p-Indicator">}</span><span class="l l-Scalar l-Scalar-Plain">latDDmodpsLUWDqwd/adk/j2tTDgz3NX</span>
<span class="linenos" data-linenos=" 8 "></span><span class="nt">loginshell</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/bin/bash</span>
<span class="linenos" data-linenos=" 9 "></span><span class="nt">uidNumber</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10001</span>
<span class="linenos" data-linenos="10 "></span><span class="nt">gidNumber</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10001</span>
<span class="linenos" data-linenos="11 "></span><span class="nt">homeDirectory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/home/javier</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">ldapadd -x -W -D &quot;cn=admin,dc=pandora,dc=ldap&quot; -f javier.ldif</span>
</code></pre></div>
<ol start="2">
<li>Para borrarlo se utilizaría: </li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">ldapdelete -W -D &quot;cn=admin,dc=pandora,dc=ldap&quot; &quot;uid=javier,ou=aso,dc=pandora,dc=ldap&quot;</span>
</code></pre></div>
</li>
<li>
<p>modificar <code>uidnumber</code> de usuario existente <code>ldapmodify</code></p>
<ol>
<li>Se crea un archivo .ldif especificando las modificaciones:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">nano cambios1.ldif</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">dn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">uid=javier,ou=aso,dc=pandora,dc=ldap</span>
<span class="linenos" data-linenos="2 "></span><span class="l l-Scalar l-Scalar-Plain">changetype:modify</span>
<span class="linenos" data-linenos="3 "></span><span class="l l-Scalar l-Scalar-Plain">replace:uidNumber</span>
<span class="linenos" data-linenos="4 "></span><span class="l l-Scalar l-Scalar-Plain">uidNumber:10002</span>
</code></pre></div>
<ol start="2">
<li>Para modificarlo se utilizaría: </li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">ldapmodify -x -W -D &quot;cn=admin,dc=pandora,dc=ldap&quot; -f cambios1.ldif</span>
</code></pre></div>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>Cuatro tipos de cambios son posibles<ol>
<li>add--adds a new entry</li>
<li>modify--changes an existing entry, that is, it adds, deletes, or replaces attributes of the entry</li>
<li>delete--deletes an existing entry</li>
<li>modrdn--modifies the RDN of an existing entry</li>
</ol>
</li>
</ul>
</div>
<ol start="4">
<li>
<p>Añadir y cambiar contraseña a un usuario existente con <code>ldappasswd</code></p>
<ol>
<li>Añadir contraseña</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">ldappasswd -s 1234 -W -D &quot;cn=admin,dc=pandora,dc=ldap&quot; -x &quot;uid=javier,ou=aso,dc=pandora,dc=ldap&quot;</span>
</code></pre></div>
</li>
</ol>
<h4 id="operaciones">Operaciones<a class="headerlink" href="#operaciones" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><code>ldapwhoami</code> : muestra con qué entrada estoy vinculado al servidor</p>
</li>
<li>
<p><code>ldapcompare</code> : compara un campo en la entrada con algún valor</p>
</li>
</ul>
<h2 id="configuracion-de-openldap">Configuración de OpenLDAP<a class="headerlink" href="#configuracion-de-openldap" title="Permanent link">&para;</a></h2>
<h3 id="slapdconf"><code>slapd.conf</code><a class="headerlink" href="#slapdconf" title="Permanent link">&para;</a></h3>
<p>Es el archivo principal de OpenLDAP y es aquí donde se configuran todos sus parámetros.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><code>slapd.conf</code>se encuentra dentro del directorio <code>/etc/ldap/slapd.d</code></li>
</ul>
</div>
<h4 id="diseno-de-configuracion">Diseño de configuración<a class="headerlink" href="#diseno-de-configuracion" title="Permanent link">&para;</a></h4>
<p>La configuración de slapd se almacena <strong>como un directorio LDAP especial con un esquema y DIT predefinidos</strong>. </p>
<ul>
<li>Hay clases de objetos específicas que se utilizan para llevar opciones de configuración global, definiciones de esquema, definiciones de base de datos y back-end, y otros elementos variados.</li>
</ul>
<figure>
  <img src="imagenes/02/ConfigTreeLDAP.png" width="600"/>
  <figcaption>Árbol de configuración de muestra.</figcaption>
</figure>

<ul>
<li>En el servidor se podría observar:</li>
</ul>
<figure>
  <img src="imagenes/02/TreeLDAPconf.png" width="400"/>
  <figcaption>Árbol (DIT)de configuración En Ubuntu Server.</figcaption>
</figure>

<p>El árbol de configuración de slapd-config tiene una estructura muy específica. La raíz del árbol se denomina cn = config y contiene ajustes de configuración global.</p>
<h4 id="directivas-de-configuracion">Directivas de configuración<a class="headerlink" href="#directivas-de-configuracion" title="Permanent link">&para;</a></h4>
<p>De las directivas más comunes mostradas en el arblo se destaca centro de <code>cn = config</code> la directiva <code>olcLogLevel</code></p>
<ul>
<li>Esta directiva especifica el nivel en el que las declaraciones de depuración y las estadísticas de operación deben registrarse en el syslog (actualmente registrado en la función <strong>syslogd (8) LOG_LOCAL4 )</strong>. </li>
<li>Debe haber configurado OpenLDAP --enable-debug (el predeterminado) para que esto funcione (excepto para los dos niveles de estadísticas, que siempre están habilitados).</li>
</ul>
<h5 id="configuracion-logging">Configuración logging<a class="headerlink" href="#configuracion-logging" title="Permanent link">&para;</a></h5>
<p>El registro de actividad para slapd es muy útil cuando se implementa una solución basada en OpenLDAP, pero debe habilitarse manualmente después de la instalación del software. De lo contrario, solo aparecerán mensajes rudimentarios en los registros. El registro, como cualquier otra configuración similar, se habilita a través de la base de datos <strong>slapd-config</strong> .</p>
<ul>
<li>OpenLDAP viene con múltiples niveles de registro y cada uno contiene el más bajo (aditivo). </li>
<li>Un buen nivel para probar son las <em>estadísticas</em> . La página de manual de <a href="https://manpages.ubuntu.com/manpages/focal/en/man5/slapd-config.5.html?_ga=2.248400327.1524111619.1636497214-637147953.1635270894">slapd-config</a> tiene más que decir sobre los diferentes subsistemas.</li>
</ul>
<ol>
<li>Cree el archivo <code>logging.ldif</code> con el siguiente contenido:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">dn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cn=config</span>
<span class="linenos" data-linenos="2 "></span><span class="nt">changetype</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">modify</span>
<span class="linenos" data-linenos="3 "></span><span class="nt">replace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">olcLogLevel</span>
<span class="linenos" data-linenos="4 "></span><span class="nt">olcLogLevel</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">stats</span>
</code></pre></div>
<ol start="2">
<li>Implementar el cambio:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">sudo ldapmodify -Q -Y EXTERNAL -H ldapi:/// -f logging.ldif</span>
</code></pre></div>
<p>Esto producirá una cantidad significativa de registro y querrá volver a un nivel menos detallado una vez que su sistema esté en producción. Mientras está en este modo detallado, el motor syslog de su host (rsyslog) puede tener dificultades para mantenerse al día y puede dejar caer mensajes:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>rsyslogd-2177: imuxsock lost 228 messages from pid 2547 due to rate-limiting</strong></p>
</div>
<p>Puede considerarse un cambio en la configuración de <code>rsyslog</code>. En <code>/etc/rsyslog.conf</code>, ponga:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1"># Disable rate limiting</span>
<span class="linenos" data-linenos="2 "></span><span class="c1"># (default is 200 messages in 5 seconds; below we make the 5 become 0)</span>
<span class="linenos" data-linenos="3 "></span><span class="l l-Scalar l-Scalar-Plain">$SystemLogRateLimitInterval 0</span>
</code></pre></div>
<ol start="3">
<li>Y luego reinicie el demonio rsyslog:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">sudo systemctl restart syslog.service</span>
</code></pre></div>
<ol start="4">
<li>Los Registros de OpenLDAP a través de syslogd <strong>LOCAL4</strong> (Nivel warning de Syslog). Para transmitir el registro LDAP a un archivo separado de syslog, agregue una línea como esta a <strong>syslog.conf</strong> ( <code>/etc/rsyslog.conf</code>):</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="c1"># a. agregar a syslog.conf</span>
<span class="linenos" data-linenos=" 2 "></span><span class="l l-Scalar l-Scalar-Plain">local4. * /var/log/ldap.log</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="l l-Scalar l-Scalar-Plain"># b. crear un archivo de registro vacío</span>
<span class="linenos" data-linenos=" 5 "></span><span class="l l-Scalar l-Scalar-Plain">toque /var/log/ldap.log</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="l l-Scalar l-Scalar-Plain"># c. reiniciar syslogd</span>
<span class="linenos" data-linenos=" 8 "></span><span class="l l-Scalar l-Scalar-Plain">killall -HUP syslogd</span>
<span class="linenos" data-linenos=" 9 "></span><span class="l l-Scalar l-Scalar-Plain">O</span>
<span class="linenos" data-linenos="10 "></span><span class="l l-Scalar l-Scalar-Plain">systemctl restart syslog.service</span>
</code></pre></div>
<p><a href="http://www.zytrax.com/books/ldap/ch6/#logfile">Más información sobre looging OpenLdap</a></p>
<h2 id="actividades-iniciales">Actividades Iniciales<a class="headerlink" href="#actividades-iniciales" title="Permanent link">&para;</a></h2>
<p><a href="Practica01_LDAP.html">Configuración básica e instalación de OpenLDAP</a></p>
<ul>
<li>base.ldif</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">dn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ou=usuarios,dc=pandora,dc=ldap</span>
<span class="linenos" data-linenos="2 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">organizationalUnit</span>
<span class="linenos" data-linenos="3 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">top</span>
<span class="linenos" data-linenos="4 "></span><span class="nt">ou</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">usuarios</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="nt">dn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ou=grupos,dc=pandora,dc=ldap</span>
<span class="linenos" data-linenos="7 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">organizationalUnit</span>
<span class="linenos" data-linenos="8 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">top</span>
<span class="linenos" data-linenos="9 "></span><span class="nt">ou</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">grupos</span>
</code></pre></div>
<ul>
<li>content.ldif </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="nt">dn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cn=devops,ou=grupos,dc=pandora,dc=ldap</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">posixGroup</span>
<span class="linenos" data-linenos=" 3 "></span><span class="nt">cn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">devops</span>
<span class="linenos" data-linenos=" 4 "></span><span class="nt">gidNumber</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="linenos" data-linenos=" 5 "></span><span class="nt">memberUid</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">devops</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="nt">dn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">uid=mordecai,ou=usuarios,dc=pandora,dc=ldap</span>
<span class="linenos" data-linenos=" 8 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inetOrgPerson</span>
<span class="linenos" data-linenos=" 9 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">posixAccount</span>
<span class="linenos" data-linenos="10 "></span><span class="nt">objectClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">shadowAccount</span>
<span class="linenos" data-linenos="11 "></span><span class="nt">cn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Mordecai</span>
<span class="linenos" data-linenos="12 "></span><span class="nt">sn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Geek</span>
<span class="linenos" data-linenos="13 "></span><span class="nt">userPassword</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">SSHA</span><span class="p p-Indicator">}</span><span class="l l-Scalar l-Scalar-Plain">latDDmodpsLUWDqwd/adk/j2tTDgz3NX</span>
<span class="linenos" data-linenos="14 "></span><span class="nt">loginshell</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/bin/bash</span>
<span class="linenos" data-linenos="15 "></span><span class="nt">uidNumber</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="linenos" data-linenos="16 "></span><span class="nt">gidNumber</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="linenos" data-linenos="17 "></span><span class="nt">homeDirectory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/home/mordecai</span>
</code></pre></div>
<h2 id="actividades-desarrollo-ud2_01">Actividades Desarrollo UD2_01<a class="headerlink" href="#actividades-desarrollo-ud2_01" title="Permanent link">&para;</a></h2>
<p><a name="Actividades Desarrollo UD2_01"></a>
<a href="Practica02_LDAP.html">Creación de usuarios y grupos OpenLDAP</a></p>
<h2 id="actividades-desarrollo-ud2_02">Actividades Desarrollo UD2_02<a class="headerlink" href="#actividades-desarrollo-ud2_02" title="Permanent link">&para;</a></h2>
<p><a href="Practica03_LDAP.html">Configuración de equipo cliente</a></p>
<h2 id="actividades-desarrollo-ud2_03">Actividades Desarrollo UD2_03<a class="headerlink" href="#actividades-desarrollo-ud2_03" title="Permanent link">&para;</a></h2>
<ol start="201">
<li>En este ejercicio se deben utilizar los <strong>comandos de OpenLdap</strong> instalados en el paquete <code>LDAPutils</code>.<ol>
<li>Añade un nuevo grupo y dentro de el un nuevo usuario a la estructura de directorio creada en la práctica superior.</li>
<li>Crea una contraseña para el usuario.</li>
<li>Modifica el uid creado de inicio.</li>
<li>Crea un segundo usuario, dentro de <strong>usuarios</strong></li>
<li>Elimina el segundo usuario creado.</li>
</ol>
</li>
</ol>
<p>En cada subapartado comprueba que se han introducido correctamente las modificaciones en el <strong>DIT</strong>.</p>
<h2 id="actividades-desarrollo-ud2_04">Actividades Desarrollo UD2_04<a class="headerlink" href="#actividades-desarrollo-ud2_04" title="Permanent link">&para;</a></h2>
<p><a href="phpLDAPadmin.html">Instalación y configuración phpLDAPadmin</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Pie">
      
        
        <a href="021_Introduccion_SD.html" class="md-footer__link md-footer__link--prev" aria-label="Anterior: 2.1- Introducción de servicios de directorio" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              2.1- Introducción de servicios de directorio
            </div>
          </div>
        </a>
      
      
        
        <a href="023_ActiveDirectory.html" class="md-footer__link md-footer__link--next" aria-label="Siguiente: 2.3- Active Directory" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Siguiente
              </span>
              2.3- Active Directory
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            2021-2022 Fº Javier Hernández - Licencia CC BY-NC-SA
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="mailto:<fj.hernandez@edu.gva.es>" target="_blank" rel="noopener" title="" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM178.117 262.104C87.429 196.287 88.353 196.121 64 177.167V152c0-13.255 10.745-24 24-24h272c13.255 0 24 10.745 24 24v25.167c-24.371 18.969-23.434 19.124-114.117 84.938-10.5 7.655-31.392 26.12-45.883 25.894-14.503.218-35.367-18.227-45.883-25.895zM384 217.775V360c0 13.255-10.745 24-24 24H88c-13.255 0-24-10.745-24-24V217.775c13.958 10.794 33.329 25.236 95.303 70.214 14.162 10.341 37.975 32.145 64.694 32.01 26.887.134 51.037-22.041 64.72-32.025 61.958-44.965 81.325-59.406 95.283-70.199z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": ["header.autohide", "toc.integrate"], "translations": {"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}, "search": "assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.756773cc.min.js"></script>
      
    
  </body>
</html>